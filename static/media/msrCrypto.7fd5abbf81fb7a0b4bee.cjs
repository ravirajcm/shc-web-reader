"use strict";var msrCryptoVersion="1.6.5";!function(e,r){"function"===typeof define&&define.amd?define([],(function(){return e.msrCrypto=r(e)})):"object"===typeof exports?module.exports=r(e):e.msrCrypto=r(e)}(this,(function(e){e=e||{};return function(){var r={register:function(e,t,n){r[e]||(r[e]={});var o=r[e];o[t]||(o[t]=n)},exists:function(e,t){return!!r[e]&&!!r[e][t]}},t=function(){if("undefined"!==typeof document)try{throw new Error}catch(r){if(r.stack){var e=/\w+:\/\/(.+?\/)*.+\.js/.exec(r.stack);return e&&e.length>0?e[0]:null}}else if("undefined"!==typeof self&&"undefined"!==typeof self.location)return self.location.href;return null}(),n="undefined"!==typeof Worker,o="function"===typeof importScripts&&self instanceof WorkerGlobalScope,a=!1,u="undefined"!==typeof ArrayBuffer,s=function(){try{return Object.defineProperty({},"oncomplete",{}),!0}catch(e){return!1}}(),c=!1,l=function(e,r,t,n,o){if(s){var i={};n&&(i.get=n),o&&(i.set=o),Object.defineProperty(e,r,i)}else e[r]=t},f={},y=function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function r(r){for(r=r.replace(/-/g,"+").replace(/_/g,"/");r.length%4!==0;)r+="=";var t,n,o,i,a,u,s,c=[];for(r=r.replace(/[^A-Za-z0-9\+\/\=]/g,""),s=0;s<r.length;s+=4)t=e.indexOf(r.charAt(s))<<2|(i=e.indexOf(r.charAt(s+1)))>>4,n=(15&i)<<4|(a=e.indexOf(r.charAt(s+2)))>>2,o=(3&a)<<6|(u=e.indexOf(r.charAt(s+3))),c.push(t),64!==a&&c.push(n),64!==u&&c.push(o);return c}function t(e){return Object.prototype.toString.call(e).slice(8,-1)}function n(e){return[e>>>24&255,e>>>16&255,e>>>8&255,255&e]}function o(e){if(!e)return[];if(e.pop)return e;if("ArrayBuffer"===t(e)?e=new Uint8Array(e):e.BYTES_PER_ELEMENT>1&&(e=new Uint8Array(e.buffer)),1===e.length)return[e[0]];if(e.length<65536)return Array.apply(null,e);for(var r=new Array(e.length),n=0;n<e.length;n++)r[n]=e[n];return r}return{consoleLog:function(e){"console"in self&&"log"in console&&console.log(e)},toBase64:function(r,n){var i=t(r);if("Array"!==i&&"Uint8Array"!==i&&"ArrayBuffer"!==i)throw new Error("invalid input");var a,u,s,c,l,f,y,h,p="",g=o(r);for(n||(n=!1),h=0;h<g.length;h+=3)c=(a=g[h])>>2,l=(3&a)<<4|(u=g[h+1])>>4,f=(15&u)<<2|(s=g[h+2])>>6,y=63&s,isNaN(u)?f=y=64:isNaN(s)&&(y=64),p=p+e.charAt(c)+e.charAt(l)+e.charAt(f)+e.charAt(y);return n?p.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,""):p},fromBase64:r,checkParam:function(e,r,n){if(!e)throw new Error(n);if(r&&t(e)!==r)throw new Error(n);return!0},getObjectType:t,bytesToHexString:function(e,r){var t="";"undefined"===typeof r&&(r=!1);for(var n=0;n<e.length;n++){r&&n%4===0&&0!==n&&(t+="-");var o=e[n].toString(16).toUpperCase();1===o.length&&(t+="0"),t+=o}return t},bytesToInt32:function(e,r){return e[r=r||0]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]},stringToBytes:function(e){for(var r=[],t=0,n=0;t<e.length;t++){var o=e.charCodeAt(t);o<128?r[n++]=o:o<2048?(r[n++]=o>>>6|192,r[n++]=63&o|128):o<55296||o>57343?(r[n++]=o>>>12|224,r[n++]=o>>>6&63|128,r[n++]=63&o|128):(o=1024*(o-55296)+(e.charCodeAt(++t)-56320)+65536,r[n++]=o>>>18|240,r[n++]=o>>>12&63|128,r[n++]=o>>>6&63|128,r[n++]=63&o|128)}return r},bytesToString:function(e){var r,t="";e=o(e);for(var n=0;n<e.length;){var i=e[n++];if((r=i<128?i:i<224?(i<<6)+e[n++]-12416:i<240?(i<<12)+(e[n++]<<6)+e[n++]-925824:(i<<18)+(e[n++]<<12)+(e[n++]<<6)+e[n++]-63447168)>65535){var a=Math.floor((r-65536)/1024)+55296,u=(r-65536)%1024+56320;t+=String.fromCharCode(a,u)}else t+=String.fromCharCode(r)}return t},unpackData:function(e,t,n){var o,i=r(e),a=[];if(isNaN(t))return i;for(o=0;o<i.length;o+=t)a.push(i.slice(o,o+t));if(n)for(o=0;o<a.length;o++)a[o]=(a[o][0]<<24)+(a[o][1]<<16)+(a[o][2]<<8)+a[o][3];return a},hexToBytesArray:function(e){e=e.replace(/\-/g,"");for(var r=[];e.length>=2;)r.push(parseInt(e.substring(0,2),16)),e=e.substring(2,e.length);return r},int32ToBytes:n,int32ArrayToBytes:function(e){for(var r=[],t=0;t<e.length;t++)r=r.concat(n(e[t]));return r},toArray:o,arraysEqual:function(e,r){var t=!0;e.length!==r.length&&(t=!1);for(var n=0;n<e.length;n++)e[n]!==r[n]&&(t=!1);return t},clone:function(e){var r={};for(var t in e)e.hasOwnProperty(t)&&(r[t]=e[t]);return r},xorVectors:function(e,r,t){for(var n=Math.min(e.length,r.length),o=(t=t||new Array(n),0);o<n;o+=1)t[o]=e[o]^r[o];return t},padEnd:function(e,r,t){for(;e.length<t;)e.push(r);return e},padFront:function(e,r,t){for(;e.length<t;)e.unshift(r);return e},getVector:function(e,r){isNaN(r)&&(r=0);for(var t=new Array(e),n=0;n<e;n+=1)t[n]=r;return t},verifyByteArray:function(e){if("Array"!==t(e))return!1;for(var r,n=0;n<e.length;n++)if(r=e[n],isNaN(r)||r<0||r>255)return!1;return!0}}}(),h=function(){var e={0:"CUSTOM",1:"BOOLEAN",2:"INTEGER",3:"BIT STRING",4:"OCTET STRING",5:"NULL",6:"OBJECT IDENTIFIER",16:"SEQUENCE",17:"SET",19:"PRINTABLE STRING",23:"UTCTime"};function r(e,t){var n=new Array(t+1).join(" ")+e.type+" ("+e.length+") "+bytesToHexString(e.data).substring(0,16)+"\n";if(!e.children)return n;for(var o=0;o<e.children.length;o++)n+=r(e.children[o],t+4)+"";return n}return{parse:function r(t,n){n=!!n;var o,i,a,u=e[31&t[0]],s=t[1],c=0,l=!!(32&t[0]);if(128&s)for(c=0,s=0;c<(127&t[1]);c++)s=(s<<8)+t[2+c];if(a=2+c,void 0===u||s>t.length)return null;var f=l?[]:{};if(f.type=u,f.header=a,f.data=t.slice(0,s+a),l||n)for("BIT STRING"===f.type&&0===t[a]&&c++,o=t.slice(a,f.data.length);o.length>0&&null!==(i=r(o));)f.push(i),o=o.slice(i.data.length);return f},encode:function(e){throw new Error("not implemented")},toString:function(e){return r(e,0)}}}(),p=function(){function e(e){return a&&o&&self.postMessage(e),e}return{jsCryptoRunner:function(t){t.data.workerid,t.data.operationType,t.data.operationSubType;var n=t.data.operationType,o=r[n][t.data.algorithm.name],i=t.data;if(!r.exists(n,t.data.algorithm.name))throw new Error("unregistered algorithm.");return i.operationSubType?e({type:i.operationSubType,result:o(i)}):e(o(i))},returnResult:e}}();o&&(self.onmessage=function(e){if(!a&&e.data.prngSeed){var r=e.data.prngSeed;return z.init(r),a=!0,p.returnResult({initialized:!0})}!0===a&&p.jsCryptoRunner(e)});var g=function(){var e=y;function r(e){var r=e.algorithm.name.slice(0,3).toUpperCase();return"RSA"===r?"RSA":"ECD"===r?"EC":"oct"}function t(e){return e.hash.name.substring(e.hash.name.indexOf("-")+1)}var n={HMAC:function(e){return"HS"+t(e)},"AES-CBC":function(e){return"A"+e.length.toString()+"CBC"},"AES-GCM":function(e){return"A"+e.length.toString()+"GCM"},"RSAES-PKCS1-V1_5":function(e){return"RSA1_5"},"RSASSA-PKCS1-V1_5":function(e){return"RS"+t(e)},"RSA-OAEP":function(e){return"SHA-1"===e.hash.name.toUpperCase()?"RSA-OAEP":"RSA-OAEP-"+t(e)},"RSA-PSS":function(e){return"PS"+t(e)},ECDSA:function(e){return"EC-"+e.namedCurve.substring(e.namedCurve.indexOf("-")+1)}};return{keyToJwkOld:function(t,n){var o={};if(o.kty=r(t),o.extractable=t.extractable,n.pop)o.k=e.toBase64(n,!0);else for(var i in n)n[i].pop&&(o[i]=e.toBase64(n[i],!0));return t.algorithm.namedCurve&&(o.crv=t.algorithm.namedCurve),function(e){for(var r=[],t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return 0===r[r.length-1]&&r.pop(),r}(JSON.stringify(o,null,"\t"))},keyToJwk:function(t,o){var i={};if(i.kty=r(t),i.ext=t.extractable,n[t.algorithm.name.toUpperCase()]&&(i.alg=n[t.algorithm.name.toUpperCase()](t.algorithm)),i.key_ops=t.usages,o.pop)i.k=e.toBase64(o,!0);else for(var a in o)o[a].pop&&"key_ops"!==a&&(i[a]=e.toBase64(o[a],!0));return t.algorithm.namedCurve&&(i.crv=t.algorithm.namedCurve),i},jwkToKey:function(r,t,n){for(var o=JSON.parse(JSON.stringify(r)),i=0;i<n.length;i+=1){var a=o[n[i]];a&&(o[n[i]]=e.fromBase64(a))}return o}}}();var d=d||function(){for(var e=24,r=Math.floor(3),t=16777215,n=16777216,o=t,i=1/n,a=[1,256],u=2;u<=r;u++)a[u]=256*a[u-1];var s=[0],c=[1];function l(e){var r,t=null;if(arguments.length&&"number"!==typeof arguments[0]){if("object"===typeof arguments[0])for(t=new Array(e.length),r=0;r<e.length;r+=1)t[r]=e[r]}else for(t=new Array(e),r=0;r<e;r+=1)t[r]=0;return t}function f(e,r,t,n,o){for(;o-- >0;)t[n+o]=e[r+o]}function y(e){var r,t=0;for(r=0;r<e.length;r+=1)t|=e[r];return!t}function h(e){var t=Math.floor((e.length+r-1)/r),o=new Array(t);o[0]=0;for(var i=0,u=0,s=0,c=e.length-1;c>=0;c--)i+=a[s++]*(255&e[c]),a[s]===n&&(s=0,o[u++]=i,i=0);for(0!==i&&(o[u]=i);null==o[--t];)o[t]=0;return o}function p(r,t){if("undefined"===typeof t)if(r<=1)t=1;else{var o=Math.log(r)/Math.LN2;t=Math.ceil(o/e)}for(var i=[];r>0;)i.push(r%n),r=Math.floor(r/n);for(;i.length<t;)i.push(0);return i}function g(e){for(var r=e.length-1;r>=0;r--)if(void 0!==e[r]&&0!==e[r])return r;return 0===e[0]?-1:0}function m(e,r){var t,n,o=0;for(n=0;n<Math.max(e.length,r.length);n++)o=(t=~~e[n]-~~r[n])+(o&-!t);return o}function v(e,r,t){var n=g(e);if(e.length=r||n+1,t)for(;++n<e.length;)e[n]=0;return e.length<=0&&(e[0]=0,e.length=1),e}function w(r,n,o,i){if(void 0===o)o=1;else if(o>=e||o<0)throw new Error("bit count must be smaller than DIGIT_BITS and positive in shiftLeft");void 0===i&&(i=r.length);var a=e-o;n[i]=r[i-1]>>>e-o||n[i];for(var u=i-1;u>0;u--)n[u]=(r[u]<<o|r[u-1]>>>a)&t;n[0]=r[0]<<o&t}function b(r,n,o){var i=r,a=n;n.length<r.length&&(i=n,a=r);var u,s=i.length,c=0;for(u=0;u<s;u+=1)c+=i[u]+a[u],o[u]=c&t,c>>=e;for(u=s;u<a.length;u+=1)c+=a[u],o[u]=c&t,c>>=e;return o.length=a.length,0!==c&&(o[u]=c&t),c}function k(r,n,o){var i=n.length;if(r.length<n.length&&(i=g(n)+1,r.length<i))throw new Error("Subtrahend is longer than minuend, not supported.");var a,u=0;for(a=0;a<i;a+=1)u+=r[a]-n[a],o[a]=u&t,u>>=e;for(;a<r.length;)u+=r[a],o[a++]=u&t,u>>=e;return u}function E(e,r,n){r="number"===typeof r?[r]:r;var o,a,u,s,c,l,f,y,h=e.length,p=r.length;for(o=0;o<h+p;o+=1)n[o]=0;o=0,s=0;for(var g=0;o<p;){for(s=Math.min(s+31,p);o<s;o++)for(y=r[o],a=0;a<h;a++)n[o+a]+=e[a]*y;for(c=0,u=g;u<o+h;u++)f=(l=n[u]+c)&t,n[u]=f,c=(l-f)*i;n[u]=c,g+=31}return n.length=h+p,n}function x(r,o,i,a,u,s){var c,l,y,h,p,d,m,b=g(r)+1,k=g(o)+1;if(b<k)return f(r,0,a,0,r.length),a.length=r.length,v(a),i[0]=0,void(i.length=1);if(0===k||1===k&&0===o[k-1])throw new Error("Division by zero.");if(1===k){for(p=o[0],l=0,m=b-1;m>=0;m--)h=l*n+r[m],i[m]=h/p&t,l=h-i[m]*p&t;return i.length=b,v(i),a[0]=l,void(a.length=1)}var E=23-function(r){for(var t=0,n=0;n<e;n++)t=Math.max(t,-(r>>>n&1)&n);return t}(o[k-1]),x=u||[];x.length=k,w(o,x,E,k);var A=s||[];for(A.length=b,w(r,A,E,b),A[b]=A[b]||0,i.length=b-k+1,a.length=k,m=b-k;m>=0;m--){for(c=Math.floor((A[m+k]*n+A[m+k-1])/x[k-1]),l=A[m+k]*n+A[m+k-1]-c*x[k-1];(c>=n||c*x[k-2]>l*n+A[m+k-2])&&(c-=1,(l+=x[k-1])<n););for(y=0,d=0;d<k;d++)h=c*x[d],p=A[d+m]-y-(h&t),A[d+m]=p&t,y=Math.floor(h/n)-Math.floor(p/n);if(p=A[m+k]-y,A[m+k]=p&t,i[m]=c&t,p<0){for(i[m]=i[m]-1,y=0,d=0;d<k;d++)p=A[d+m]+x[d]+y,A[d+m]=p&t,y=p>>e;A[m+k]=A[m+k]+y&t}}for(d=0;d<k;d++)a[d]=(A[d]>>>E|A[d+1]<<e-E)&t;v(i),v(a)}function A(e,r,t,n,o){var i;if(y(e))return f(r,0,o,0,r.length),o.length=r.length,0;if(y(r))return f(e,0,o,0,e.length),o.length=e.length,0;m(e,r)<0?(i=e.slice(0),f(r,0,o,0,r.length),o.length=r.length):(i=r.slice(0),f(e,0,o,0,e.length),o.length=e.length),v(o),v(i);var a,u,s=new Array(o.length),c=new Array(o.length),l=new Array(o.length),h=void 0!==n;h&&((a=new Array(o.length))[0]=1,a.length=1,n[0]=0,n.length=1);var p=new Array(o.length),g=void 0!==t;g&&((u=new Array(o.length))[0]=0,u.length=1,t[0]=1,t.length=1);for(var d,w=-1,k=t,A=n,S=o;!y(i);)x(o,i,s,c,p,l),g&&(E(s,u,p),b(p,t,p),v(p),d=t,t=u,u=p,p=d),h&&(E(s,a,l),b(l,n,l),v(l),d=n,n=a,a=l,l=d),d=o,o=i,i=c,c=d,w++;return g&&(f(t,0,k,0,t.length),k.length=t.length),h&&(f(n,0,A,0,n.length),A.length=n.length),f(o,0,S,0,o.length),S.length=o.length,w}function S(e,r,t,n){if(n=n||[],0===m(r,s))n[0]=1;else if(0===m(r,c))f(e,0,n,0,e.length),n.length=e.length;else{var o=new M(t);v(e,o.s,!0),o.modExp(e,r,n),n.length=t.length}return n}function M(r,n){function o(r){for(var n=1,o=2,i=3,a=i&r,u=2;u<=e;u+=1)o<a&&(n+=o),o<<=1,a=r*n&(i=i<<1|1);return 1+(~n&t)}function a(e,r,n,o){for(var a,u,c,f,y,h,p,g,m=(o=o||this).m,v=m.length,w=o.mPrime,b=o.m0,k=0,E=0,x=l(v+2);k<v;){for(E=Math.min(v,E+16);k<E;){for(a=~~r[k],c=((u=x[0]+e[0]*a)&t)*w&t,x[1]+=(b*c+u)*i|0,f=1,y=0;f<v;y=f,f+=1)x[y]=x[f]+m[f]*c+e[f]*a;x[y]=x[f],x[f]=0,k++}for(g=0,f=0;f<v;f++)p=(h=x[f]+g)&t,x[f]=p,g=(h-p)*i;x[f]=g}for(k=0;k<v;k+=1)n[k]=x[k];n.length=v;var A=+(d.compareDigits(x,m)>0);d.subtract(n,m,o.temp2),s(A,n,o.temp2)}function u(e,r,t){var n,o,i,a,u;for(n=0;n<e[0].length;n++)t[n]=0;for(o=0;o<e.length;o++)for(a=e[o],i=-(r===o),u=0;u<a.length;u++)t[u]=t[u]|a[u]&i}function s(e,r,t){for(var n=-e,o=~n,i=0;i<r.length;i++)r[i]=r[i]&o|t[i]&n}n=n||function(e){var r=e.length,t=e[0],n={m:e,mPrime:o(t),m0:t,temp1:l(2*r+1),temp2:l(2*r+1)},i=l(2*e.length);i[i.length]=1,n.mu=[],x(i,e,n.mu,[]);var u=l(2*r+1),s=l(r+1),c=l(2*r+1),f=l(2*r+1),y=s;y[r]=1,x(y,e,u,s,c,f),n.rModM=v(s,r,!0);var h=l(2*r+1),p=h;return p[2*r]=1,x(p,e,u,h,c,f),n.rSquaredModm=v(h,r,!0),n.rCubedModm=l(r),a(h,h,n.rCubedModm,n),n}(r);var c=n.m,f=n.mu,y=n.m0,h=c.length,p=l(h+1).slice(0,h);p[0]=1;var g=n.mPrime,w=n.rModM,b=n.rSquaredModm,A=n.rCubedModm,S=l(2*h+1),M=l(2*h+1),D=new Array(4);return D[0]=w,D[1]=new Array(h),D[2]=new Array(h),D[3]=new Array(h),{m:c,m0:y,mPrime:g,mu:f,rSquaredModm:b,s:h,rModM:w,rCubedModm:A,one:p,temp1:S,temp2:M,convertToMontgomeryForm:function(e){if(e.length<this.s){e.length=this.s;for(var r=0;r<this.s;r++)e[r]=isNaN(e[r])?0:e[r]}var t=l(e.length);for(this.montgomeryMultiply(e,this.rSquaredModm,t),r=0;r<this.s;r+=1)e[r]=t[r]},convertToStandardForm:function(e){this.montgomeryMultiply(e,this.one,this.temp1);for(var r=0;r<this.s;r+=1)e[r]=this.temp1[r]},montgomeryMultiply:a,modExp:function(r,t,n,o){o=!!o;var i,a,s=function(r){var t,n,o=2,i=r*e;n=4+3*Math.ceil(i/2)+1;do{o++,t=n,n=Math.pow(2,o)+Math.ceil(i/o)*(o+1)+1}while(n<t);return o-1}(t.length),c=function(r,t){var n,o=r.length,i=(new Array(o*e),0),a=0,u=0,s=0,c=new Array(Math.ceil(o*e/t));for(u=0,c[0]=0;i<o;i++)for(a=0,n=r[i];a<e;a++,n>>>=1)u===t&&(c[++s]=0,u=0),c[s]+=(1&n)<<u++;return c}(t,s).reverse(),l=this.rModM.slice(0),f=Math.pow(2,s),y=D;for(y.length=f,y[0]=this.rModM,i=1;i<f;i++)y[i]=[],E(y[i-1],r,y[i]),this.reduce(y[i]);var h,p=[];for(i=0;i<c.length;i++){for(a=0;a<s;a++)this.montgomeryMultiply(l,l,l);h=c[i],o?p=y[h]:u(y,h,p),this.montgomeryMultiply(l,p,l)}return this.montgomeryMultiply(l,this.one,n),n},reduce:function(e,r){var t,n,o,i,a,u,l=this.m.length,f=[];for(r=r||e,t=[],E(e.slice(l-1),this.mu,t),n=t.slice(l+1),o=e.slice(0,l+1),E(n,c,i=[]),i=i.slice(0,l+1),o[l+1]=m(o,i)>>>31,a=0;a<r.length;a++)r[a]=0;k(o,i,r),u=+(m(r,c)>0),d.subtract(r,c,f),s(u,r,f),v(r)},ctx:n}}return{DIGIT_BITS:e,DIGIT_NUM_BYTES:r,DIGIT_MASK:t,DIGIT_BASE:n,DIGIT_MAX:o,Zero:s,One:c,normalizeDigitArray:v,bytesToDigits:h,stringToDigits:function(e,r){e=e.replace(/^\s+|\s+$/g,"");var t=[0],n=[0];r=r||10;for(var o=0;o<e.length;o+=1){var i=parseInt(e[o],r);if(isNaN(i))throw new Error("Failed to convert string to integer in radix "+r.toString());E(t,r,n),b(n,[i],t),v(t)}return t},digitsToString:function(e,r){if(n<=(r=r||10))throw new Error("DIGIT_BASE is smaller than RADIX; cannot convert.");var t,o=e.length,i=[],a=[],u=[],s=[],c=[],l=[],f="",y="0";for(c[0]=r;Math.floor(n/c[0])>=r;)c[0]=c[0]*r,y=y.concat("0");for(t=0;t<o;t+=1)l[t]=e[t];for(;;){var h=!0;for(t=0;t<l.length;t+=1)if(0!==l[t]){h=!1;break}if(h)break;x(l,c,i,a,u,s),v(i,l.length,!0);var p=a[0].toString(r);f=y.substring(0,y.length-p.length)+p+f;var g=l;l=i,i=g}for(;0!==f.length&&"0"===f[0];)f=f.substring(1,f.length);return 0===f.length&&(f="0"),f},intToDigits:p,digitsToBytes:function(e,t,n){var o,i,a,u=[0];for("undefined"===typeof t&&(t=!0),o=0;o<e.length;o+=1)for(a=e[o],i=0;i<r;i+=1)u[o*r+i]=255&a,a=Math.floor(a/256);if(u.reverse(),void 0===n&&(n=1),t)for(;u.length>n&&0===u[0];)u.shift();return u},isZero:y,isEven:function(e){return 0===(1&e[0])},shiftRight:function(r,n,o,i){if(void 0===o)o=1;else if(o>=e||o<0)throw new Error("Invalid bit count for shiftRight");void 0===i&&(i=r.length);for(var a=i-1,u=e-o,s=0;s<a;s++)n[s]=(r[s+1]<<u|r[s]>>>o)&t;n[a]=r[a]>>>o},shiftLeft:w,compareDigits:m,bitLength:function(e){for(var r=0,t=0;r<e.length;){if(0===t)for(var n=7;n>=0&&0===t;){var o=1<<n;(e[r]&o)===o&&(t=n+1),n--}else t+=8;r+=1}return t},fixedWindowRecode:function(e,r,t){e=e.slice();for(var n=[],o=Math.pow(2,r),i=Math.pow(2,r-1),a=0;a<t;a++)n[a]=e[0]%o-i,e[0]=e[0]-n[a],d.shiftRight(e,e,r-1);return n[a]=e[0],n},IntegerGroup:function(r){var n=h(r),o=n.length,i=p(0,o),a=p(1,o),u=l(o),s=l(o);function c(e,r){return{m_digits:e,m_group:r,equals:function(e){return 0===m(this.m_digits,e.m_digits)&&this.m_group.equals(this.m_group,e.m_group)}}}return{m_modulus:n,m_digitWidth:o,montmul:new M(n),createElementFromInteger:function(e){return c(p(e,this.m_digitWidth),this)},createElementFromBytes:function(e){var r=h(e);if(d.compareDigits(r,this.m_modulus)>=0)throw new Error("The number provided is not an element of this group");return v(r,this.m_digitWidth,!0),c(r,this)},createElementFromDigits:function(e){return d.normalizeDigitArray(e,this.m_digitWidth,!0),c(e,this)},equals:function(e){return 0===m(this.m_modulus,e.m_modulus)},add:function(r,n,o){var i,a=this.m_digitWidth,u=o.m_digits;d.add(r.m_digits,n.m_digits,u);var s=(m(u,this.m_modulus)>>>31)-1&t,c=0;for(i=0;i<a;i+=1)c=u[i]-(this.m_modulus[i]&s)+c,u[i]=c&t,c>>=e;u.length=a},subtract:function(r,n,o){var i,a=this.m_digitWidth,u=o.m_digits,s=d.subtract(r.m_digits,n.m_digits,o.m_digits);if(-1===s)for(s=0,i=0;i<a;i+=1)s+=u[i]+this.m_modulus[i],u[i]=s&t,s>>=e},multiply:function(e,r,t){return d.modMul(e.m_digits,r.m_digits,this.m_modulus,t.m_digits,u,s)},inverse:function(e,r){d.modInv(e.m_digits,this.m_modulus,r.m_digits)},modexp:function(e,r,t){if(t=t||c([],this),0===m(r,i))t.m_digits=p(1,this.m_digitWidth);else if(0===m(r,a)){for(var n=0;n<e.m_digits.length;n++)t.m_digits[n]=e.m_digits[n];t.m_digits.length=e.m_digits.length}else this.montmul.modExp(e.m_digits,r,t.m_digits),t.m_digits.length=this.montmul.s;return t}}},add:b,subtract:k,multiply:E,divRem:x,reduce:function(e,r,t,n,o){return x(e,r,[],t,n,o),t},modInv:function(e,r,t,n){var o=new Array(r.length),i=new Array(r.length),a=new Array(r.length),u=A(e,r,i,o,a);return t=t||[],0!==m(a,c)?(t[0]=NaN,t.length=1):(1===(1&u)?k(r,o,t):(f(o,0,t,0,o.length),t.length=o.length),n?v(t,r.length,!0):v(t)),t},modInvCT:function(e,r,t,n){var o=[];return t=t||[],k(r,[2],o),S(e,o,r,t),v(t),t},modExp:S,modMul:function(e,r,t,n,o,i){var a=[];return E(e,r,a),x(a,t,a,n,o,i),n},MontgomeryMultiplier:M,gcd:function(e,r,t){var n=e,o=r;return m(e,r)>0&&(n=r,o=e),A(n,o,void 0,void 0,t),v(t)},sequenceEqual:function(e,r){for(var t=e.length===r.length,n=0;n<Math.min(e.length,r.length);n+=1)e[n]!==r[n]&&(t=!1);return t},swapEndianness:function(e){return e.reverse()},computeBitArray:function(e){for(var r=l(8*e.length),t=0,n=e.length-1;n>=0;){for(var o=0;o<8;){var i=1<<o,a=(e[n]&i)===i?1:0,u=8*(e.length-n-1)+o;1===a&&(t=u+1),r[u]=a,o+=1}n--}return r.slice(0,t)}}}();var m=m||function(){var e=d.bytesToDigits;function r(e){var r,t=null;if(arguments.length&&"number"!==typeof arguments[0]){if("object"===typeof arguments[0])for(t=[],r=0;r<e.length;r+=1)t[r]=e[r]}else for(t=[],r=0;r<e;r+=1)t[r]=0;return t}var t=function(e,r,t,o,i,a){var u=e.length;return{p:e,a:r,b:t,order:o,generator:n(this,!1,i,a,null,!1),allocatePointStorage:function(){return n(this,!1,d.intToDigits(0,u),d.intToDigits(0,u))},createPointAtInfinity:function(){return n(this,!0,d.intToDigits(0,u),d.intToDigits(0,u))}}},n=function(e,t,o,i,a,u){var c;return"undefined"===typeof a&&(a=null),"undefined"===typeof u&&(u=!1),l(c={equals:function(e){return function(e){return!!e&&(!(!c.isInfinity||!e.isInfinity)||(null!==c.z||null===e.z)&&(null===c.z||null!==e.z)&&(null===c.z?0===d.compareDigits(c.x,e.x)&&0===d.compareDigits(c.y,e.y)&&c.isInMontgomeryForm===e.isInMontgomeryForm:0===d.compareDigits(c.x,e.x)&&0===d.compareDigits(c.y,e.y)&&0===d.compareDigits(c.z,e.z)&&c.isInMontgomeryForm===e.isInMontgomeryForm))}(e)},copy:function(e){!function(e,r){if(r.curve=e.curve,r.x=e.x.slice(),r.y=e.y.slice(),null!==e.z?r.z=e.z.slice():r.z=null,s||(r.isAffine=e.isAffine),r.isInMontgomeryForm=e.isInMontgomeryForm,r.isInfinity=e.isInfinity,!r.equals(e))throw new Error("Instances should be equal.")}(this,e)},clone:function(){return function(){var e=n(c.curve,c.isInfinity,r(c.x),r(c.y),c.z?r(c.z):null,c.isInMontgomeryForm);return c.ta&&(e.ta=r(c.ta)),c.tb&&(e.tb=r(c.tb)),e}()}},"curve",e,(function(){return e}),(function(r){e=r})),l(c,"x",o,(function(){return o}),(function(e){o=e})),l(c,"y",i,(function(){return i}),(function(e){i=e})),l(c,"z",a,(function(){return a}),(function(e){a=e})),l(c,"isInMontgomeryForm",u,(function(){return u}),(function(e){u=e})),l(c,"isInfinity",t,(function(){return t}),(function(e){t=e})),l(c,"isAffine",null===a,(function(){return null===a})),c},o=function(e){var t=1===e.type,n=e.p.length,o=d.MontgomeryMultiplier(e.p),a=e.a.slice();o.convertToMontgomeryForm(a);var u=d.isZero(e.a),c=d.One,l=r(n);l[0]=1,o.convertToMontgomeryForm(l);var f=d.IntegerGroup(d.digitsToBytes(o.m),!0),y=r(n),h=r(n),p=r(n),g=r(n),m=r(n),v=r(n),w=r(n),b=r(n),k=r(n),E=r(n),x=r(n),A=r(n);function S(e,r,t){var n=f.createElementFromInteger(0);n.m_digits=t,f.subtract(f.createElementFromDigits(e),f.createElementFromDigits(r),n)}function M(e,r,t){var n=f.createElementFromInteger(0);n.m_digits=t,f.add(f.createElementFromDigits(e),f.createElementFromDigits(r),n)}function D(r,t){var n=r.length,o=e.p;if(1===(1&r[0])){for(var i=0,a=0;a<n;a+=1)i+=r[a]+o[a],t[a]=i&d.DIGIT_MASK,i>>>=d.DIGIT_BITS;i<<=d.DIGIT_BITS-1,d.shiftRight(t,t),t[n-1]|=i}else d.shiftRight(r,t)}function T(e,r,t){o.montgomeryMultiply(e,r,t)}function K(e,r){o.montgomeryMultiply(e,e,r)}function I(e,r){var t=r.clone();if(z(t),!N(t))throw new Error("Invalid Parameter");var n=r.clone();q(n);var o,i=[r.clone()],a=n.clone(),u=n.clone();C(n,u),U(u);for(var s=1;s<Math.pow(2,e-2);s++)P(a,u,a),U(o=a.clone()),i[s]=o;return i}function C(e,r){if("undefined"===typeof e)throw new Error("point undefined");if("undefined"===typeof r)throw new Error("outputPoint undefined");if(e.isAffine)throw new Error("Given point was in Affine form. Use convertToJacobian() first.");if(!e.isInMontgomeryForm)throw new Error("Given point must be in Montgomery form. Use montgomeryize() first.");u?function(e,r){if(e.isInfinity)r.isInfinity=!0;else{K(e.y,g),K(e.x,m),M(m,m,y),M(y,m,m),T(e.x,g,v),K(g,y),D(m,h),K(h,g),T(e.y,e.z,k);for(var t=0;t<k.length;t+=1)r.z[t]=k[t];S(g,v,r.x),S(r.x,v,r.x),S(v,r.x,m),T(h,m,p),S(p,y,r.y),r.isInfinity=!1,r.isInMontgomeryForm=!0}}(e,r):function(e,r){e.isInfinity?r.isInfinity=!0:(K(e.z,h),T(e.z,e.y,m),M(e.x,h,p),S(e.x,h,h),r.z=m.slice(),T(h,p,g),D(g,p),M(g,p,h),K(e.y,p),K(h,m),T(e.x,p,g),S(m,g,m),S(m,g,r.x),S(g,r.x,m),K(p,g),T(h,m,p),S(p,g,r.y),r.isInfinity=!1,r.isInMontgomeryForm=!0)}(e,r)}function H(e,r,t){if(e.isInfinity)return r.copy(t),void this.convertToJacobianForm(t);if(r.isInfinity)e.copy(t);else{if(K(e.z,v),T(e.z,v,w),T(r.x,v,m),T(r.y,w,v),S(m,e.x,h),S(v,e.y,p),d.isZero(h))return d.isZero(p)?(C(e,t),void P(t,r,t)):(t.x=e.x.slice(0),t.y=e.y.slice(0),void(t.z=e.z.slice(0)));if(K(p,m),K(h,w),T(w,e.x,v),T(h,w,y),S(m,v,g),S(g,v,g),T(e.z,h,m),S(g,v,g),T(y,e.y,w),S(g,y,g),d.isZero(g)){for(i=0;i<t.x.length;i++)t.x[i]=0,t.y[i]=0,t.z[i]=0;t.y[0]=1}else M(w,w,h),T(m,g,t.z),T(p,g,m),K(g,y),M(h,m,h),T(y,v,m),K(h,b),T(y,g,v),S(b,m,t.x),S(t.x,m,t.x),S(t.x,v,t.x),S(t.x,m,g),T(v,w,y),T(h,g,m),S(m,y,t.y),t.isInfinity=!1,t.isInMontgomeryForm=!0}}function P(e,r,t){if(null===e)throw new Error("jacobianPoint");if(null===r)throw new Error("affinePoint");if(null===t)throw new Error("outputPoint");if(e.curve!==r.curve||e.curve!==t.curve)throw new Error("All points must be from the same curve object.");if(e.isAffine)throw new Error("Given jacobianPoint was in Affine form. Use ConvertToJacobian()                     before calling DoubleJacobianAddAffinePoints().");if(!r.isAffine)throw new Error("Given affinePoint was in Jacobian form. Use ConvertToAffine() before                      calling DoubleJacobianAddAffinePoints().");if(t.isAffine)throw new Error("Given jacobianPoint was in Jacobian form. Use ConvertToJacobian() before                      calling DoubleJacobianAddAffinePoints().");if(!e.isInMontgomeryForm)throw new Error("Jacobian point must be in Montgomery form");if(!r.isInMontgomeryForm)throw new Error("Affine point must be in Montgomery form");if(e.isInfinity)return r.copy(t),void this.convertToJacobianForm(t);if(r.isInfinity)e.copy(t);else{var o;for(K(e.z,h),T(h,e.z,p),T(h,r.x,g),T(p,r.y,m),S(g,e.x,h),S(m,e.y,p),o=0;o<h.length;o+=1)if(0!==h[o]){T(e.z,h,y);for(var i=0;i<n;i+=1)t.z[i]=y[i];return K(h,g),T(g,h,m),T(g,e.x,v),M(v,v,h),K(p,t.x),S(t.x,h,t.x),S(t.x,m,t.x),S(v,t.x,g),T(p,g,v),T(e.y,m,w),S(v,w,t.y),t.isInfinity=!1,void(t.isInMontgomeryForm=!0)}for(o=0;o<p.length;o+=1)if(0!==p[o])return t.isInfinity=!0,void(t.isInMontgomeryForm=!0);r.copy(t),this.convertToJacobianForm(t),this.double(t,t),t.isInMontgomeryForm=!0}}function B(r,t,o,i){if(t.isInfinity||d.isZero(r))o.isInfinity=!0;else{if(d.compareDigits(r,e.order)>=0)throw new Error("The scalar k must be in the range 1 <= k < order.");if(r=r.slice(),1===t.curve.type){var a="undefined"!==typeof t.ta;a||L(t),function(e,r,t,o){if(!O(r))throw new Error("Invalid Parameter");var i=r.curve.rbits;o="undefined"===typeof o||o;var a,u,s=n<=8?5:6,c=Math.floor((i+(s-2))/(s-1));e=e.slice();var l=r.clone();L(l),o&&(G(l,l),G(l,l));var f=j(1<<s-2,l),y=1&e[0],h=[];for(S(r.curve.order,e,h),a=0;a<e.length;a++)e[a]=y-1&(e[a]^h[a])^e[a];var p=d.fixedWindowRecode(e,s,c),g=Math.floor(Math.abs(p[c])-1)/2,m=f[g];for(l.x=m.x.slice(),l.y=m.y.slice(),l.z=m.z.slice(),a=c-1;a>=0;a--){for(u=0;u<s-1;u++)G(l,l);var v=W(f,g=Math.floor((Math.abs(p[a])-1)/2)),w=-(p[a]>>>31);S(r.curve.p,v.x,h);for(var b=0;b<v.x.length;b++)v.x[b]=v.x[b]&~w|h[b]&w;for(S(r.curve.p,v.td,h),b=0;b<v.td.length;b++)v.td[b]=v.td[b]&~w|h[b]&w;J(v,l,l)}for(S(r.curve.p,l.x,h),a=0;a<l.x.length;a++)l.x[a]=y-1&(l.x[a]^h[a])^l.x[a];V(l),t.x=l.x.slice(),t.y=l.y.slice()}(r,t,o,i),a||V(t)}else{var u=t.isInMontgomeryForm,s=o.isInMontgomeryForm,c=o.isAffine;u||R(t),s||R(o),function(e,r,t){var o=r.clone();if(z(o),!N(o))throw new Error("Invalid Parameters.");var i=1&e[0],a=[];for(S(r.curve.order,e,a),p=0;p<e.length;p++)e[p]=i-1&(e[p]^a[p])^e[p];var u=n<=8?5:6,s=r.curve.p.length*d.DIGIT_BITS,c=Math.ceil(s/(u-1)),l=d.fixedWindowRecode(e,u,c),f=I(u,r),y=Math.floor(Math.abs(l[c])-1)/2,h=f[y].clone();q(h);for(var p=c-1;p>=0;p--){for(var g=0;g<u-2;g++)C(h,h);var m=F(f,y=Math.floor((Math.abs(l[p])-1)/2));S(m.curve.p,m.y,a);for(var v=-(l[p]>>>31),w=0;w<m.y.length;w++)m.y[w]=m.y[w]&~v|a[w]&v;H(h,m,h)}for(S(r.curve.p,h.y,a),p=0;p<h.y.length;p++)h.y[p]=i-1&(h.y[p]^a[p])^h.y[p];h.copy(t)}(r,t,o),c&&U(o),u||z(t),s||z(o)}}}function F(e,r){for(var t,n,o=0;o<e.length;o++)t=+(o===r),n=[n,e[o].clone()][t];return n}function R(e){if(e.isInMontgomeryForm)throw new Error("The given point is already in Montgomery form.");e.isInfinity||(o.convertToMontgomeryForm(e.x),o.convertToMontgomeryForm(e.y),null!==e.z&&o.convertToMontgomeryForm(e.z),"undefined"!==typeof e.ta&&(o.convertToMontgomeryForm(e.ta),o.convertToMontgomeryForm(e.tb))),e.isInMontgomeryForm=!0}function z(e){if(!e.isInMontgomeryForm)throw new Error("The given point is not in montgomery form.");e.isInfinity||(o.convertToStandardForm(e.x),o.convertToStandardForm(e.y),null!==e.z&&o.convertToStandardForm(e.z),"undefined"!==typeof e.ta&&(o.convertToStandardForm(e.ta),o.convertToStandardForm(e.tb))),e.isInMontgomeryForm=!1}function U(r){if(r.isInfinity)return r.z=null,void(s||(r.isAffine=!0));if(d.modInv(r.z,e.p,A,!0),r.isInMontgomeryForm){T(A,o.rCubedModm,x);var t=A;A=x,x=t}K(A,E),T(r.x,E,x);for(var i=0;i<n;i+=1)r.x[i]=x[i];T(r.y,E,x),T(x,A,r.y),r.z=null,delete r.ta,delete r.tb,s||(r.isAffine=!0)}function q(e){if(!e.isAffine)throw new Error("The given point is not in Affine form.");s||(e.isAffine=!1);var t,n,o=e.isInMontgomeryForm?l:c;for(t=r(o.length),n=0;n<o.length;n+=1)t[n]=o[n];e.z=t}function N(e){return!e.isInfinity&&(d.modMul(e.y,e.y,e.curve.p,h),d.modMul(e.x,e.x,e.curve.p,p),d.modMul(e.x,p,e.curve.p,g),M(g,e.curve.b,p),d.modMul(e.x,e.curve.a,e.curve.p,g),M(p,g,p),S(h,p,h),!1!==d.isZero(h))}function O(e){return e.ta&&V(e=e.clone()),d.modMul(e.y,e.y,e.curve.p,g),d.modMul(e.x,e.x,e.curve.p,p),d.add(p,g,h),d.reduce(m,e.curve.p,m),d.modMul(p,g,e.curve.p,m),d.modMul(e.curve.d,m,e.curve.p,g),d.add(g,[1],p),d.reduce(p,e.curve.p,p),d.subtract(h,p,h),!1!==d.isZero(h)||(d.reduce(h,e.curve.p,h),!1!==d.isZero(h))}function j(e,r){var t=r.clone(),n=t.clone(),o=[];o[0]=Z(r),G(t,t),n=Z(t),t=r.clone();for(var i=1;i<e;i++)J(n,t,t),o[i]=Z(t);return o}function L(e){e.ta=e.x.slice(),e.tb=e.y.slice(),e.z=[1]}function W(e,r){for(var t=(r+1)%e.length,n=0;n<e.length;n++){var o={x:e[t].x.slice(),y:e[t].y.slice(),z:e[t].z.slice(),td:e[t].td.slice()};t=(t+1)%e.length}return o}function V(r){d.modInv(r.z,e.p,A,!0),d.modMul(r.x,A,e.p,r.x),d.modMul(r.y,A,e.p,r.y),delete r.ta,delete r.tb,r.z=null}function G(e,r){if("undefined"===typeof e.ta)throw new Error("Point should be in Extended Projective form.");d.modMul(e.x,e.x,e.curve.p,y),d.modMul(e.y,e.y,e.curve.p,h),d.modMul(e.z,e.z,e.curve.p,e.ta),S(h,y,r.tb),M(y,h,y),M(e.ta,e.ta,e.ta),M(e.y,e.y,e.y),S(e.ta,y,h),d.modMul(e.x,e.y,e.curve.p,r.ta),d.modMul(y,r.tb,e.curve.p,r.y),d.modMul(h,r.ta,e.curve.p,r.x),d.modMul(y,h,e.curve.p,r.z)}function Z(e){var r=e.curve,t=r.p,n={x:e.x.slice(),y:e.y.slice(),z:e.z.slice(),td:[],curve:e.curve};return d.modMul(e.ta,e.tb,t,E),d.modMul(E,r.d,t,n.td),n}function J(e,r,t){var n=d,o=r.curve.p;h=[],p=[],g=[],n.modMul(r.z,e.z,o,g),n.modMul(r.ta,r.tb,o,h),M(r.x,r.y,r.ta),n.modMul(h,e.td,o,p),M(e.x,e.y,r.tb),S(g,p,h),M(g,p,g),n.modMul(r.ta,r.tb,o,p),n.modMul(r.x,e.x,o,r.z),n.modMul(r.y,e.y,o,r.x),S(p,r.z,p),S(r.x,r.z,t.ta),S(p,r.x,t.tb),n.modMul(t.ta,g,o,t.y),n.modMul(t.tb,h,o,t.x),n.modMul(g,h,o,t.z)}var Q={convertToMontgomeryForm:R,convertToStandardForm:z,convertToAffineForm:U,convertToJacobianForm:q,generatePrecomputationTable:function(e,r){return I(e,r)}};return t?(Q.double=G,Q.add=function(e,r,t){if("undefined"===typeof e.ta)throw new Error("Point1 should be in Extended Projective form.");if("undefined"===typeof r.ta)throw new Error("Point2 should be in Extended Projective form.");J(Z(e),r,t)},Q.scalarMultiply=B,Q.normalize=V,Q.convertToExtendedProjective=L,Q.convertTedToWeierstrass=function(e,r){var t=e.curve.a.slice(),n=e.curve.d.slice(),o=e.curve.p,i=d.modMul,a=d.modInv;i(t,h=[5],o,p),S(p,n,p),i(n,h,o,g),S(t,g,h),i(e.y,h,o,g),M(g,p,p),S(h=[1],e.y,g),i(h=[12],g,o,m),a(m,o,m,!0),i(e.x,g,o,h),M(h,h,g),M(g,g,g),a(g,o,g,!0),i(m,p,o,r.x),h=[1],M(e.y,h,h),S(t,n,p),i(h,p,o,m),i(m,g,o,r.y)},Q.convertWeierstrassToTed=function(e,r){var t=r.curve.a.slice(),n=r.curve.d.slice(),o=r.curve.p,i=d.modMul,a=d.modInv;M(e.x,e.x,h),M(e.x,h,h),M(h,h,h),S(h,t,p),S(p,n,p),M(e.y,e.y,g),M(e.y,g,g),M(g,g,g),a(g,o,g,!0),i(p,g,o,r.x),M(h,h,h),M(h,n,p),M(h,t,h),M(t,t,g),S(p,g,p),S(p,g,p),S(p,t,p),M(n,n,g),S(h,g,h),S(h,g,h),S(h,n,h),a(h,o,h,!0),i(h,p,o,r.y)},Q.validatePoint=O,Q.generatePrecomputationTable=function(e,r){return j(e,r)}):(Q.double=C,Q.mixedDoubleAdd=H,Q.mixedAdd=P,Q.scalarMultiply=B,Q.negate=function(e,r){e!==r&&e.copy(r),S(e.curve.p,e.y,r.y)},Q.validatePoint=N),Q},a={},u=function(r){var n=a[r.toUpperCase()];if(!n)throw new Error(r+" Unsupported curve.");if(0===n.type)return function(r){var n=new t(e(r.p),e(r.a),e(r.b),e(r.order),e(r.gx),e(r.gy));return n.type=r.type,n.name=r.name,n.generator.curve=n,n}(n);if(1===n.type)return function(r){var n=new t(e(r.p),e(r.a),e(r.d),e(r.order),e(r.gx),e(r.gy));return n.type=r.type,1===n.type&&(n.d=n.b.slice(),delete n.b),n.rbits=r.info[2],n.name=r.name,n.generator.curve=n,n}(n);throw new Error(r+" Unsupported curve type.")};return{createCurve:u,curves:a,sec1EncodingFp:function(){return{encodePoint:function(e){if(!e)throw new Error("point");if(!e.isAffine)throw new Error("Point must be in affine form.");if(e.isInMontgomeryForm)throw new Error("Point must not be in Montgomery form.");if(e.isInfinity)return r(1);var t=d.digitsToBytes(e.x),n=d.digitsToBytes(e.y),o=d.digitsToBytes(e.curve.p).length;if(o<t.length||o<n.length)throw new Error("Point coordinate(s) are bigger than the field order.");var i=r(2*o+1);i[0]=4;for(var a=o-t.length,u=0;u<t.length;u++)i[u+1+a]=t[u];for(a=o-n.length,u=0;u<n.length;u++)i[o+u+1+a]=n[u];return i},decodePoint:function(e,t){if(e.length<1)throw new Error("Byte array must have non-zero length");var o=d.digitsToBytes(t.p).length;if(0===e[0]&&1===e.length)return t.createPointAtInfinity();if(4===e[0]&&e.length===1+2*o){for(var i=r(o),a=r(o),u=0;u<o;u++)i[u]=e[u+1],a[u]=e[o+u+1];var s=d.bytesToDigits(i),c=d.bytesToDigits(a);return n(t,!1,s,c)}throw new Error("Unsupported encoding format")}}},validatePoint:function(r,t,i,a){var s=u(r),c=new n(s,!1,e(t),e(i),a&&e(a),!1);return new o(s).validatePoint(c)},EllipticCurvePointFp:n,EllipticCurveOperatorFp:o,ModularSquareRootSolver:function(e){var r=e,t=[];if("undefined"===typeof e)throw new Error("modulus");if(d.isEven(e))throw new Error("Only odd moduli are supported");var n=d.MontgomeryMultiplier(r);r[0]%4===3?(d.add(r,d.One,t),d.shiftRight(t,t,2)):t=null;var o=new Array(r.length),i=new Array(r.length);return{squareRoot:function(e){if(null!==t)return function(e){var r=d.intToDigits(0,16);n.modExp(e,t,r);var o=[0];return d.modMul(r,r,n.m,o),0!==d.compareDigits(e,o)?null:r}(e);throw new Error("GeneralCase not supported.")},jacobiSymbol:function(e){var t,n;t=e.slice(),n=r.slice(),d.reduce(t,n,t,o,i);for(var a=1;!d.isZero(t);){for(;d.isEven(t);){d.shiftRight(t,t);var u=7&n[0];3!==u&&5!==u||(a=-a)}var s=t;t=n,n=s;var c=3&t[0],l=3&n[0];3===c&&3===l&&(a=-a),d.reduce(t,n,t,o,i)}return 0===d.compareDigits(n,d.One)?a:0}}}}}();"undefined"!==typeof m&&(m.curves["P-256"]={name:"P-256",type:0,p:[255,255,255,255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255],a:[255,255,255,255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,252],b:[90,198,53,216,170,58,147,231,179,235,189,85,118,152,134,188,101,29,6,176,204,83,176,246,59,206,60,62,39,210,96,75],order:[255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,255,188,230,250,173,167,23,158,132,243,185,202,194,252,99,37,81],gx:[107,23,209,242,225,44,66,71,248,188,230,229,99,164,64,242,119,3,125,129,45,235,51,160,244,161,57,69,216,152,194,150],gy:[79,227,66,226,254,26,127,155,142,231,235,74,124,15,158,22,43,206,51,87,107,49,94,206,203,182,64,104,55,191,81,245],cf:1},m.curves["P-384"]={name:"P-384",type:0,p:[255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,255,255,0,0,0,0,0,0,0,0,255,255,255,255],a:[255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,255,255,0,0,0,0,0,0,0,0,255,255,255,252],b:[179,49,47,167,226,62,231,228,152,142,5,107,227,248,45,25,24,29,156,110,254,129,65,18,3,20,8,143,80,19,135,90,198,86,57,141,138,46,209,157,42,133,200,237,211,236,42,239],order:[255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,199,99,77,129,244,55,45,223,88,26,13,178,72,176,167,122,236,236,25,106,204,197,41,115],gx:[170,135,202,34,190,139,5,55,142,177,199,30,243,32,173,116,110,29,59,98,139,167,155,152,89,247,65,224,130,84,42,56,85,2,242,93,191,85,41,108,58,84,94,56,114,118,10,183],gy:[54,23,222,74,150,38,44,111,93,158,152,191,146,146,220,41,248,244,29,189,40,154,20,124,233,218,49,19,181,240,184,192,10,96,177,206,29,126,129,157,122,67,29,124,144,234,14,95],cf:1},m.curves["P-521"]={name:"P-521",type:0,p:[1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255],a:[1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,252],b:[0,81,149,62,185,97,142,28,154,31,146,154,33,160,182,133,64,238,162,218,114,91,153,179,21,243,184,180,137,145,142,241,9,225,86,25,57,81,236,126,147,123,22,82,192,189,59,177,191,7,53,115,223,136,61,44,52,241,239,69,31,212,107,80,63,0],order:[1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,250,81,134,135,131,191,47,150,107,127,204,1,72,247,9,165,208,59,181,201,184,137,156,71,174,187,111,183,30,145,56,100,9],gx:[0,198,133,142,6,183,4,4,233,205,158,62,203,102,35,149,180,66,156,100,129,57,5,63,181,33,248,40,175,96,107,77,61,186,161,75,94,119,239,231,89,40,254,29,193,39,162,255,168,222,51,72,179,193,133,106,66,155,249,126,126,49,194,229,189,102],gy:[1,24,57,41,106,120,154,59,192,4,92,138,95,180,44,125,27,217,152,245,68,73,87,155,68,104,23,175,189,23,39,62,102,44,151,238,114,153,94,244,38,64,197,80,185,1,63,173,7,97,53,60,112,134,162,114,194,64,136,190,148,118,159,209,102,80],cf:1});"undefined"!==typeof m&&(m.curves["BN-254"]={name:"BN-254",type:0,p:[37,35,100,130,64,0,0,1,186,52,77,128,0,0,0,8,97,33,0,0,0,0,0,19,167,0,0,0,0,0,0,19],a:[0],b:[2],order:[37,35,100,130,64,0,0,1,186,52,77,128,0,0,0,7,255,159,128,0,0,0,0,16,161,0,0,0,0,0,0,13],gx:[37,35,100,130,64,0,0,1,186,52,77,128,0,0,0,8,97,33,0,0,0,0,0,19,167,0,0,0,0,0,0,18],gy:[1],cf:1});var v={info:["numsp256d1",256,256,256],type:0,p:[67,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),a:[64,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),b:[129,85,2].reverse(),order:[37,168,81,71,41,32,171,32,96,92,38,234,117,130,60,228,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),gx:[177,172,26,178,30,238,82,188,58,199,212,3,9,155,87,131,9,203,66,79,160,149,122,41,97,219,170,90,182,214,158,188].reverse(),gy:[159,222,132,33,203,185,181,128,187,15,49,21,209,195,85,201,53,224,4,126,247,139,68,115,166,182,153,51,241,192,143,208].reverse(),cf:1},w={info:["numsp256t1",256,255,256],name:"numsp256t1",type:1,p:[67,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),a:[1],d:[85,195,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),order:[245,74,221,238,144,177,71,26,155,67,89,47,165,90,149,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64].reverse(),gx:[218,19,237,46,144,192,222,160,134,53,8,227,14,138,57,12,214,155,32,105,95,61,30,205,125,35,234,106,251,20,117,138].reverse(),gy:[230,137,138,121,231,22,166,47,211,110,133,16,216,97,95,113,16,128,75,166,217,101,150,206,199,37,217,217,159,62,213,68].reverse(),cf:4},b={info:["numsp384d1",384,384,384],name:"numsp384d1",type:0,p:[195,254,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),a:[192,254,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),b:[187,119,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),order:[185,97,14,123,246,129,77,96,122,226,55,76,61,157,218,190,129,104,93,235,30,175,30,214,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),gx:[42,21,152,32,4,186,156,235,123,196,97,15,16,237,46,82,66,199,108,42,27,41,189,243,244,249,129,251,205,193,37,2,166,241,5,65,34,202,128,72,28,24,111,177,240,86,121,117].reverse(),gy:[22,7,24,102,236,184,116,92,38,173,244,191,219,180,214,188,126,131,26,18,125,131,32,185,156,115,127,248,119,105,4,176,126,207,132,5,48,61,227,215,56,142,155,225,104,227,222,172].reverse(),cf:1},k={info:["numsp384t1",384,382,384],name:"numsp384t1",type:1,p:[195,254,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),a:[1],d:[159,209,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),order:[125,137,163,230,196,220,185,32,121,200,53,171,90,85,228,97,207,225,107,180,28,26,71,226,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,63].reverse(),gx:[222,107,32,108,228,64,213,80,19,148,69,101,177,146,242,111,64,99,49,243,168,255,99,87,0,76,190,229,70,244,11,179,181,93,229,154,18,162,182,192,108,38,169,69,251,17,177,97].reverse(),gy:[146,147,114,240,225,3,141,157,220,72,236,70,249,176,114,0,75,150,69,246,247,152,15,131,86,95,66,241,116,130,173,22,215,13,177,35,164,177,56,135,176,238,166,185,103,62,152,130].reverse(),cf:4},E={info:["numsp512d1",512,512,512],name:"numsp512d1",type:0,p:[199,253,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),a:[196,253,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),b:[155,217,1].reverse(),order:[93,85,51,4,57,63,21,206,67,210,124,96,54,139,86,59,198,189,208,151,237,88,194,79,27,131,231,148,251,164,60,91,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),gx:[87,174,171,140,149,135,130,220,226,93,111,125,19,96,93,29,131,21,86,37,134,66,121,147,158,53,107,7,81,161,33,80,249,217,6,83,194,224,6,69,133,246,1,181,59,216,202,152,82,59,61,160,2,112,43,218,147,10,29,20,71,52,192,58].reverse(),gy:[166,39,53,56,96,135,160,35,233,15,253,76,30,92,43,207,2,86,90,178,64,168,33,193,233,237,14,139,218,21,132,162,20,79,209,123,12,38,75,143,140,187,188,171,222,219,151,75,0,177,235,99,220,238,14,206,179,86,173,41,202,84,58,148].reverse(),cf:4},x={info:["numsp512t1",512,510,512],name:"numsp512t1",type:1,p:[199,253,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),a:[1].reverse(),d:[239,203,254,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),order:[109,212,238,27,245,140,70,103,255,236,239,109,120,5,70,42,245,134,182,112,201,216,63,158,186,145,207,47,109,99,240,180,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,63].reverse(),gx:[254,87,236,153,41,171,185,197,21,240,196,124,66,37,229,15,173,4,137,86,146,201,189,120,15,115,70,238,78,193,33,70,71,129,59,39,190,126,161,39,130,163,196,77,159,231,209,47,51,197,211,136,120,203,24,122,156,182,141,18,109,49,142,223].reverse(),gy:[225,245,226,193,192,222,109,50,31,208,241,155,138,211,102,2,253,193,236,42,134,6,26,96,98,53,150,233,242,83,202,32,65,131,158,144,149,107,43,169,34,157,37,216,38,247,118,228,110,37,42,168,119,245,176,152,113,202,73,157,243,191,9,109].reverse(),cf:4};"undefined"!==typeof m&&(m.curves.NUMSP256D1=v,m.curves.NUMSP384D1=b,m.curves.NUMSP512D1=E,m.curves.NUMSP256T1=w,m.curves.NUMSP384T1=k,m.curves.NUMSP512T1=x);var A=function(e,r,t,n,o,i,a){var u=y,s=t.slice(),c=new Array(o),l=[],f=0;function h(e){for(var r=Math.floor(e.length/o),t=0;t<r;t++)i(e,t,s,n,c);return f+=r,e.slice(r*o)}function p(){if(0!==h(function(e){var r=o-e.length%o;r<=o/8&&(r+=o);var t=u.getVector(r);t[0]=128;for(var n=8*(e.length+f*o),i=1;i<=8;i++)t[r-i]=n%256,n=Math.floor(n/256);return e.concat(t)}(l)).length)throw new Error("buffer.length !== 0");var e=function(){for(var e=[],r=0;r<s.length;r++)e=e.concat(u.int32ToBytes(s[r]));return e.length=a/8,e}();return l=[],s=t.slice(),f=0,e}return{name:e,computeHash:function(e){return l=h(e),p()},process:function(e){(l=l.concat(e)).length>=o&&(l=h(l))},finish:p,der:r,hashLen:a,maxMessageSize:4294967295}},S=function(){function e(e,t,n,o,i){var a,u,s,c,l=4294967295,f=n[0],y=n[1],h=n[2],p=n[3],g=n[4];for(u=0;u<16;u++)i[u]=r.bytesToInt32(e,64*t+4*u);for(a=16;a<80;a++)c=i[a-3]^i[a-8]^i[a-14]^i[a-16],i[a]=c<<1|c>>>31;for(u=0;u<80;u++)s=f<<5|f>>>27,s+=u>=60?y^h^p:u>=40?y&h^y&p^h&p:u>=20?y^h^p:y&h^~y&p,s+=g+o[u]+i[u],g=p,p=h,h=y<<30|y>>>2,y=f,f=s;return n[0]+=f&l,n[1]+=y&l,n[2]+=h&l,n[3]+=p&l,n[4]+=g&l,n}var r=y,t=r.unpackData,n=t("Z0UjAe/Nq4mYutz+EDJUdsPS4fA=",4,1),o=t("WoJ5mVqCeZlagnmZWoJ5mVqCeZlagnmZWoJ5mVqCeZlagnmZWoJ5mVqCeZlagnmZWoJ5mVqCeZlagnmZWoJ5mVqCeZlagnmZWoJ5mVqCeZlu2euhbtnroW7Z66Fu2euhbtnroW7Z66Fu2euhbtnroW7Z66Fu2euhbtnroW7Z66Fu2euhbtnroW7Z66Fu2euhbtnroW7Z66Fu2euhbtnroY8bvNyPG7zcjxu83I8bvNyPG7zcjxu83I8bvNyPG7zcjxu83I8bvNyPG7zcjxu83I8bvNyPG7zcjxu83I8bvNyPG7zcjxu83I8bvNyPG7zcymLB1spiwdbKYsHWymLB1spiwdbKYsHWymLB1spiwdbKYsHWymLB1spiwdbKYsHWymLB1spiwdbKYsHWymLB1spiwdbKYsHWymLB1spiwdY",4,1),i=t("MCEwCQYFKw4DAhoFAAQU");return{sha1:function(){return A("SHA-1",i,n,o,64,e,160)}}}();"undefined"!==typeof r&&(S.instances={},S.getInstance=function(e){return S.instances[e]||(S.instances[e]=S.sha1())},S.deleteInstance=function(e){S.instances[e]=null,delete S.instances[e]},S.hash=function(e){if("process"!==e.operationSubType)return"finish"===e.operationSubType?S.sha1.finish():S.sha1().computeHash(e.buffer);S.sha1.process(e.buffer)},r.register("digest","SHA-1",S.hash)),f["SHA-1"]=S.sha1;var M=function(){var e=y;function r(r,t,n,o,i){var a,u,s,c,l,f=n[0],y=n[1],h=n[2],p=n[3],g=n[4],d=n[5],m=n[6],v=n[7];for(u=0;u<16;u++)i[u]=e.bytesToInt32(r,64*t+4*u);for(a=16;a<64;a++)c=i[a-15],l=i[a-2],i[a]=((l>>>17|l<<15)^(l>>>19|l<<13)^l>>>10)+i[a-7]+((c>>>7|c<<25)^(c>>>18|c<<14)^c>>>3)+i[a-16],i[a]=4294967295&i[a];for(u=0;u<64;u++)p+=s=v+((g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7))+(g&d^~g&m)+o[u]+i[u],s+=((f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10))+(f&(y^h)^y&h),v=m,m=d,d=g,g=p,p=h,h=y,y=f,f=s;return n[0]=n[0]+f>>>0,n[1]=n[1]+y>>>0,n[2]=n[2]+h>>>0,n[3]=n[3]+p>>>0,n[4]=n[4]+g>>>0,n[5]=n[5]+d>>>0,n[6]=n[6]+m>>>0,n[7]=n[7]+v>>>0,n}var t,n,o,i,a,u=e.unpackData;return n=u("wQWe2DZ81QcwcN0X9w5ZOf/ACzFoWBURZPmPp776T6Q",4,1),o=u("agnmZ7tnroU8bvNypU/1OlEOUn+bBWiMH4PZq1vgzRk",4,1),t=u("QoovmHE3RJG1wPvP6bXbpTlWwltZ8RHxkj+CpKscXtXYB6qYEoNbASQxhb5VDH3Dcr5ddIDesf6b3AanwZvxdOSbacHvvkeGD8GdxiQMocwt6SxvSnSEqlywqdx2+YjamD5RUqgxxm2wAyfIv1l/x8bgC/PVp5FHBspjURQpKWcntwqFLhshOE0sbfxTOA0TZQpzVHZqCruBwskuknIshaK/6KGoGmZLwkuLcMdsUaPRkugZ1pkGJPQONYUQaqBwGaTBFh43bAgnSHdMNLC8tTkcDLNO2KpKW5zKT2gub/N0j4LueKVjb4TIeBSMxwIIkL7/+qRQbOu++aP3xnF48g",4,1),i=u("MC0wDQYJYIZIAWUDBAIEBQAEHA"),a=u("MDEwDQYJYIZIAWUDBAIBBQAEIA"),{sha224:function(){return A("SHA-224",i,n,t,64,r,224)},sha256:function(){return A("SHA-256",a,o,t,64,r,256)}}}();"undefined"!==typeof r&&(M.instance224=M.instance224||M.sha224(),M.instance256=M.instance256||M.sha256(),M.instances={},M.getInstance224=function(e){return M.instances[e]||(M.instances[e]=M.sha224())},M.getInstance256=function(e){return M.instances[e]||(M.instances[e]=M.sha256())},M.deleteInstance=function(e){M.instances[e]=null,delete M.instances[e]},M.hash256=function(e){if("process"===e.operationSubType)return M.getInstance256(e.workerid).process(e.buffer),null;if("finish"===e.operationSubType){var r=M.getInstance256(e.workerid).finish();return M.deleteInstance(e.workerid),r}if("abort"!==e.operationSubType)return M.instance256.computeHash(e.buffer);M.deleteInstance(e.workerid)},M.hash224=function(e){if("process"!==e.operationSubType){if("finish"===e.operationSubType)M.getInstance224(e.workerid).finish();if("abort"!==e.operationSubType)return M.instance224.computeHash(e.buffer);msrcryptoSha224.deleteInstance(e.workerid)}else M.getInstance224(e.workerid).process(e.buffer)},r.register("digest","SHA-224",M.hash224),r.register("digest","SHA-256",M.hash256)),f["SHA-224"]=M.sha224,f["SHA-256"]=M.sha256;var D=function(){function e(e,r,t,n,o){var i=r+n|0,a=i>>>0<n>>>0;o[0]=e+t+a|0,o[1]=i}function r(r,t,n,o,i){var a,u,s,c,l,f,y,h,p,g=[],d=[],m=[],v=n[0],w=n[1],b=n[2],k=n[3],E=n[4],x=n[5],A=n[6],S=n[7],M=n[8],D=n[9],T=n[10],K=n[11],I=n[12],C=n[13],H=n[14],P=n[15];for(a=0;a<32;a++)p=128*t+4*a,i[a]=r.slice(p,p+4),i[a]=i[a][0]<<24|i[a][1]<<16|i[a][2]<<8|i[a][3];for(a=32;a<160;a+=2)s=((y=i[a-30])>>>1|(h=i[a-29])<<31)^(y>>>8|h<<24)^y>>>7,c=(h>>>1|y<<31)^(h>>>8|y<<24)^(h>>>7|y<<25),e(l=((y=i[a-4])>>>19|(h=i[a-3])<<13)^(h>>>29|y<<3)^y>>>6,f=(h>>>19|y<<13)^(y>>>29|h<<3)^(h>>>6|y<<26),i[a-14],i[a-13],g),e(s,c,g[0],g[1],g),e(i[a-32],i[a-31],g[0],g[1],g),i[a]=g[0],i[a+1]=g[1];for(u=0;u<160;u+=2)l=M&T^I&~M,f=D&K^C&~D,e(H,P,s=(M>>>14|D<<18)^(M>>>18|D<<14)^(D>>>9|M<<23),c=(D>>>14|M<<18)^(D>>>18|M<<14)^(M>>>9|D<<23),g),e(l,f,o[u],o[u+1],d),e(g[0],g[1],i[u],i[u+1],m),e(d[0],d[1],m[0],m[1],m),e(m[0],m[1],A,S,g),A=g[0],S=g[1],f=w&(k^x)^k&x,l=v&(b^E)^b&E,e(m[0],m[1],s=(v>>>28|w<<4)^(w>>>2|v<<30)^(w>>>7|v<<25),c=(w>>>28|v<<4)^(v>>>2|w<<30)^(v>>>7|w<<25),g),e(l,f,s=g[0],c=g[1],g),H=I,P=C,I=T,C=K,T=M,K=D,M=A,D=S,A=E,S=x,E=b,x=k,b=v,k=w,v=s=g[0],w=c=g[1];return e(n[0],n[1],v,w,g),n[0]=g[0],n[1]=g[1],e(n[2],n[3],b,k,g),n[2]=g[0],n[3]=g[1],e(n[4],n[5],E,x,g),n[4]=g[0],n[5]=g[1],e(n[6],n[7],A,S,g),n[6]=g[0],n[7]=g[1],e(n[8],n[9],M,D,g),n[8]=g[0],n[9]=g[1],e(n[10],n[11],T,K,g),n[10]=g[0],n[11]=g[1],e(n[12],n[13],I,C,g),n[12]=g[0],n[13]=g[1],e(n[14],n[15],H,P,g),n[14]=g[0],n[15]=g[1],n}var t,n,o,i,a,u,s,c=y.unpackData;return t=c("y7udXcEFnthimikqNnzVB5FZAVowcN0XFS/s2PcOWTlnMyZn/8ALMY60SodoWBUR2wwuDWT5j6dHtUgdvvpPpA==",4,1),n=c("agnmZ/O8yQi7Z66FhMqnOzxu83L+lPgrpU/1Ol8dNvFRDlJ/reaC0ZsFaIwrPmwfH4PZq/tBvWtb4M0ZE34heQ",4,1),o=c("QoovmNcoriJxN0SRI+9lzbXA+8/sTTsv6bXbpYGJ27w5VsJb80i1OFnxEfG2BdAZkj+CpK8ZT5urHF7V2m2BGNgHqpijAwJCEoNbAUVwb74kMYW+TuSyjFUMfcPV/7Ticr5ddPJ7iW+A3rH+OxaWsZvcBqclxxI1wZvxdM9pJpTkm2nBnvFK0u++R4Y4TyXjD8GdxouM1bUkDKHMd6ycZS3pLG9ZKwJ1SnSEqm6m5INcsKncvUH71Hb5iNqDEVO1mD5RUu5m36uoMcZtLbQyELADJ8iY+yE/v1l/x77vDuTG4AvzPaiPwtWnkUeTCqclBspjUeADgm8UKSlnCg5ucCe3CoVG0i/8LhshOFwmySZNLG38WsQq7VM4DROdlbPfZQpzVIuvY952agq7PHeyqIHCyS5H7a7mknIshRSCNTuiv+ihTPEDZKgaZku8QjABwkuLcND4l5HHbFGjBlS+MNGS6BnW71IY1pkGJFVlqRD0DjWFV3EgKhBqoHAyu9G4GaTBFrjS0MgeN2wIUUGrUydId0zfjuuZNLC8teGbSKg5HAyzxclaY07YqkrjQYrLW5zKT3dj43NoLm/z1rK4o3SPgu5d77L8eKVjb0MXL2CEyHgUofCrcozHAggaZDnskL7/+iNjHiikUGzr3oK96b75o/eyxnkVxnF48uNyUyvKJz7O6iZhnNGGuMchwMIH6tp91s3g6x71fU9/7m7ReAbwZ6pyF2+6CmN9xaLImKYRP5gEvvkNrhtxCzUTHEcbKNt39SMEfYQyyqt7QMckkzyevgoVyb68Qx1nxJwQDUxMxdS+yz5Ctll/KZz8ZX4qX8tvqzrW+uxsRBmMSkdYFw==",4,1),i=c("MEEwDQYJYIZIAWUDBAICBQAEMA"),a=c("MFEwDQYJYIZIAWUDBAIDBQAEQA"),u=c("MC0wDQYJYIZIAWUDBAIFBQAEHA"),s=c("MDEwDQYJYIZIAWUDBAIGBQAEIA"),{sha384:function(){return A("SHA-384",i,t,o,128,r,384)},sha512:function(){return A("SHA-512",a,n,o,128,r,512)},sha512_224:function(){return A("SHA-512.224",u,n,o,128,r,224)},sha512_256:function(){return A("SHA-512.256",s,n,o,128,r,256)}}}();"undefined"!==typeof r&&(D.instances={},D.getInstance384=function(e){return D.instances[e]||(D.instances[e]=D.sha384())},D.getInstance512=function(e){return D.instances[e]||(D.instances[e]=D.sha512())},D.deleteInstance=function(e){D.instances[e]=null,delete D.instances[e]},D.hash384=function(e){if("process"!==e.operationSubType)return"finish"===e.operationSubType?D.sha384.finish():D.sha384().computeHash(e.buffer);D.sha384.process(e.buffer)},D.hash512=function(e){if("process"!==e.operationSubType)return"finish"===e.operationSubType?D.sha512.finish():D.sha512().computeHash(e.buffer);D.sha512.process(e.buffer)},r.register("digest","SHA-384",D.hash384),r.register("digest","SHA-512",D.hash512)),f["SHA-384"]=D.sha384,f["SHA-512"]=D.sha512;var T=function(e,r){var t,n,o,i,a,u={384:128,512:128}[r.name.replace(/SHA-/,"")]||64,s=function(){if(e.length===u)return e;if(e.length>u)return l(r.computeHash(e),u);return l(e,u)}();function c(e,r){for(var t=new Array(e),n=0;n<e.length;n++)t[n]=e[n]^r[n];return t}function l(e,r){for(var t=e.slice(),n=e.length;n<r;n++)t.push(0);return t}function f(e){a?r.process(e):(a=i.concat(e),r.process(a))}function y(){var e=r.finish(),t=o.concat(e);return r.computeHash(t)}function h(){e=null,r=null,s=null}t=new Array(u),n=new Array(u);for(var p=0;p<u;p++)t[p]=54,n[p]=92;return i=c(s,t),o=c(s,n),{computeHmac:function(e,r,t){f(e);var n=y();return h(),n},process:function(e,r,t){return f(e),null},finish:function(e,r){var t=y();return h(),t}}};if("undefined"!==typeof r){var K={};T.signHmac=function(e){var r,t=e.keyHandle.algorithm.hash.name.toUpperCase(),n=f[t](),o=e.workerid;return K[o]||(K[o]=T(e.keyData,n)),"process"===e.operationSubType?(K[o].process(e.buffer),null):"finish"===e.operationSubType?(r=K[o].finish(),K[o]=null,r):(r=K[o].computeHmac(e.buffer),K[o]=null,r)},T.verifyHmac=function(e){var r,t=e.keyHandle.algorithm.hash.name.toUpperCase(),n=f[t](),o=e.workerid;return K[o]||(K[o]=T(e.keyData,n)),"process"===e.operationSubType?(K[o].process(e.buffer),null):"finish"===e.operationSubType?(r=K[o].finish(),r=y.arraysEqual(r,e.signature),K[o]=null,r):(r=K[o].computeHmac(e.buffer),r=y.arraysEqual(r,e.signature),K[o]=null,r)},T.generateKey=function(e){var r=e.algorithm.length;return r||(r={"SHA-1":64,"SHA-224":64,"SHA-256":64,"SHA-384":128,"SHA-512":128}[e.algorithm.hash.name.toUpperCase()]),{type:"keyGeneration",keyData:z.getBytes(r),keyHandle:{algorithm:e.algorithm,extractable:e.extractable,usages:e.usages,type:"secret"}}},T.importKey=function(e){var r;e.keyData.length;if("jwk"===e.format)(r=g.jwkToKey(e.keyData,e.algorithm,["k"])).alg=r.alg.replace("HS","SHA-");else{if("raw"!==e.format)throw new Error("unsupported import format");r={k:y.toArray(e.keyData)}}return{type:"keyImport",keyData:r.k,keyHandle:{algorithm:{name:"HMAC",hash:{name:e.algorithm.hash.name}},extractable:e.extractable||r.extractable,usages:e.usages,type:"secret"}}},T.exportKey=function(e){if("jwk"===e.format)return{type:"keyExport",keyHandle:g.keyToJwk(e.keyHandle,e.keyData)};if("raw"===e.format)return{type:"keyExport",keyHandle:e.keyData};throw new Error("unsupported export format")},r.register("importKey","HMAC",T.importKey),r.register("exportKey","HMAC",T.exportKey),r.register("generateKey","HMAC",T.generateKey),r.register("sign","HMAC",T.signHmac),r.register("verify","HMAC",T.verifyHmac)}var I=function(){var e,r,t,n,o,i,a,u,s,c;return{aes:function(l){e||(e=y.unpackData("AAIEBggKDA4QEhQWGBocHiAiJCYoKiwuMDI0Njg6PD5AQkRGSEpMTlBSVFZYWlxeYGJkZmhqbG5wcnR2eHp8foCChIaIioyOkJKUlpianJ6goqSmqKqsrrCytLa4ury+wMLExsjKzM7Q0tTW2Nrc3uDi5Obo6uzu8PL09vj6/P4bGR8dExEXFQsJDw0DAQcFOzk/PTMxNzUrKS8tIyEnJVtZX11TUVdVS0lPTUNBR0V7eX99c3F3dWtpb21jYWdlm5mfnZORl5WLiY+Ng4GHhbu5v72zsbe1q6mvraOhp6Xb2d/d09HX1cvJz83DwcfF+/n//fPx9/Xr6e/t4+Hn5QADBgUMDwoJGBseHRQXEhEwMzY1PD86OSgrLi0kJyIhYGNmZWxvaml4e359dHdycVBTVlVcX1pZSEtOTURHQkHAw8bFzM/Kydjb3t3U19LR8PP29fz/+vno6+7t5Ofi4aCjpqWsr6qpuLu+vbS3srGQk5aVnJ+amYiLjo2Eh4KBm5idnpeUkZKDgIWGj4yJiquora6npKGis7C1tr+8ubr7+P3+9/Tx8uPg5ebv7Onqy8jNzsfEwcLT0NXW39zZ2ltYXV5XVFFSQ0BFRk9MSUpraG1uZ2RhYnNwdXZ/fHl6Ozg9Pjc0MTIjICUmLywpKgsIDQ4HBAECExAVFh8cGRoADhwSODYkKnB+bGJIRlRa4O788tjWxMqQnoyCqKa0utvVx8nj7f/xq6W3uZOdj4E7NScpAw0fEUtFV1lzfW9hraOxv5WbiYfd08HP5ev5901DUV91e2lnPTMhLwULGRd2eGpkTkBSXAYIGhQ+MCIslpiKhK6gsrzm6Pr03tDCzEFPXVN5d2VrMT8tIwkHFRuhr72zmZeFi9HfzcPp5/X7mpSGiKKsvrDq5Pb40tzOwHp0ZmhCTF5QCgQWGDI8LiDs4vD+1NrIxpySgI6kqri2DAIQHjQ6KCZ8cmBuREpYVjc5KyUPARMdR0lbVX9xY23X2cvF7+Hz/aepu7WfkYONAA0aFzQ5LiNoZXJ/XFFGS9Ddysfk6f7zuLWir4yBlpu7tqGsj4KVmNPeycTn6v3wa2ZxfF9SRUgDDhkUNzotIG1gd3pZVENOBQgfEjE8Kya9sKeqiYSTntXYz8Lh7Pv21tvMweLv+PW+s6SpioeQnQYLHBEyPyglbmN0eVpXQE3a18DN7uP0+bK/qKWGi5yRCgcQHT4zJClib3h1VltMQWFse3ZVWE9CCQQTHj0wJyqxvKumhYifktnUw87t4Pf6t7qtoIOOmZTf0sXI6+bx/GdqfXBTXklEDwIVGDs2ISwMARYbODUiL2RpfnNQXUpH3NHGy+jl8v+0ua6jgI2alwALFh0sJzoxWFNORXR/Ymmwu6atnJeKgejj/vXEz9LZe3BtZldcQUojKDU+DwQZEsvA3dbn7PH6k5iFjr+0qaL2/eDr2tHMx66luLOCiZSfRk1QW2phfHceFQgDMjkkL42Gm5Chqre81d7DyPny7+Q9NisgERoHDGVuc3hJQl9U9/zh6tvQzcavpLmyg4iVnkdMUVprYH12HxQJAjM4JS6Mh5qRoKu2vdTfwsn48+7lPDcqIRAbBg1kb3J5SENeVQEKFxwtJjswWVJPRHV+Y2ixuqesnZaLgOni//TFztPYenFsZ1ZdQEsiKTQ/DgUYE8rB3Nfm7fD7kpmEj761qKMACRIbJC02P0hBWlNsZX53kJmCi7S9pq/Y0crD/PXu5zsyKSAfFg0Ec3phaFdeRUyrormwj4adlOPq8fjHztXcdn9kbVJbQEk+NywlGhMIAebv9P3Cy9DZrqe8tYqDmJFNRF9WaWB7cgUMFx4hKDM63dTPxvnw6+KVnIeOsbijquzl/vfIwdrTpK22v4CJkpt8dW5nWFFKQzQ9Ji8QGQIL197FzPP64eiflo2Eu7KpoEdOVVxjanF4DwYdFCsiOTCak4iBvrespdLbwMn2/+TtCgMYES4nPDVCS1BZZm90faGos7qFjJee6eD78s3E39YxOCMqFRwHDnlwa2JdVE9GY3x3e/Jrb8UwAWcr/terdsqCyX36WUfwrdSir5ykcsC3/ZMmNj/3zDSl5fFx2DEVBMcjwxiWBZoHEoDi6yeydQmDLBobblqgUjvWsynjL4RT0QDtIPyxW2rLvjlKTFjP0O+q+0NNM4VF+QJ/UDyfqFGjQI+SnTj1vLbaIRD/89LNDBPsX5dEF8Snfj1kXRlzYIFP3CIqkIhG7rgU3l4L2+AyOgpJBiRcwtOsYpGV5HnnyDdtjdVOqWxW9Opleq4IunglLhymtMbo3XQfS72LinA+tWZIA/YOYTVXuYbBHZ7h+JgRadmOlJseh+nOVSjfjKGJDb/mQmhBmS0PsFS7FlIJatUwNqU4v0CjnoHz1/t84zmCmy//hzSOQ0TE3unLVHuUMqbCIz3uTJULQvrDTgguoWYo2SSydluiSW2L0SVy+PZkhmiYFtSkXMxdZbaSbHBIUP3tudpeFUZXp42dhJDYqwCMvNMK9+RYBbizRQbQLB6Pyj8PAsGvvQMBE4prOpERQU9n3OqX8s/O8LTmc5asdCLnrTWF4vk36Bx1325H8RpxHSnFiW+3Yg6qGL4b/FY+S8bSeSCa28D+eM1a9B/dqDOIB8cxsRIQWSeA7F9gUX+pGbVKDS3lep+TyZzvoOA7Ta4q9bDI67s8g1OZYRcrBH66d9Ym4WkUY1UhDH2NAQIECBAgQIAbNmzYq02aL168Y8aXNWrUs33678WROXLk071hwp8lSpQzZsyDHTp06MuNAQIECBAgQIAbNmzYq02aL168Y8aXNWrUs33678WROXLk071hwp8lSpQzZsyDHTp06MuNAQIECBAgQIAbNmzYq02aL168Y8aXNWrUs33678WROXLk071hwp8lSpQzZsyDHTp06MuNAQIECBAgQIAbNmzYq02aL168Y8aXNWrUs33678WROXLk071hwp8lSpQzZsyDHTp06MuNAQIECBAgQIAbNmzYq02aL168Y8aXNWrUs33678WROXLk071hwp8lSpQzZsyDHTp06MuN",256,!1),r=e[0],t=e[1],n=e[2],o=e[3],i=e[4],a=e[5],u=e[6],s=e[7],c=e[8]);var f,h,p,g;switch(f=8*l.length){case 128:case 192:case 256:break;default:throw new Error("Unsupported keyLength")}p=(h=f/32)+6;var d=function(e){var r=e[1];e[1]=e[5],e[5]=e[9],e[9]=e[13],e[13]=r,r=e[2],e[2]=e[10],e[10]=r,r=e[6],e[6]=e[14],e[14]=r,r=e[15],e[15]=e[11],e[11]=e[7],e[7]=e[3],e[3]=r},m=function(e){var r=e[13];e[13]=e[9],e[9]=e[5],e[5]=e[1],e[1]=r,r=e[10],e[10]=e[2],e[2]=r,r=e[14],e[14]=e[6],e[6]=r,r=e[3],e[3]=e[7],e[7]=e[11],e[11]=e[15],e[15]=r},v=function(e){var n=e[0],o=e[1],i=e[2],a=e[3],u=e[4],s=e[5],c=e[6],l=e[7],f=e[8],y=e[9],h=e[10],p=e[11],g=e[12],d=e[13],m=e[14],v=e[15];e[0]=r[n]^t[o]^i^a,e[1]=n^r[o]^t[i]^a,e[2]=n^o^r[i]^t[a],e[3]=t[n]^o^i^r[a],e[4]=r[u]^t[s]^c^l,e[5]=u^r[s]^t[c]^l,e[6]=u^s^r[c]^t[l],e[7]=t[u]^s^c^r[l],e[8]=r[f]^t[y]^h^p,e[9]=f^r[y]^t[h]^p,e[10]=f^y^r[h]^t[p],e[11]=t[f]^y^h^r[p],e[12]=r[g]^t[d]^m^v,e[13]=g^r[d]^t[m]^v,e[14]=g^d^r[m]^t[v],e[15]=t[g]^d^m^r[v]},w=function(e){var r=e[0],t=e[1],u=e[2],s=e[3],c=e[4],l=e[5],f=e[6],y=e[7],h=e[8],p=e[9],g=e[10],d=e[11],m=e[12],v=e[13],w=e[14],b=e[15];e[0]=n[r]^i[t]^o[u]^a[s],e[1]=a[r]^n[t]^i[u]^o[s],e[2]=o[r]^a[t]^n[u]^i[s],e[3]=i[r]^o[t]^a[u]^n[s],e[4]=n[c]^i[l]^o[f]^a[y],e[5]=a[c]^n[l]^i[f]^o[y],e[6]=o[c]^a[l]^n[f]^i[y],e[7]=i[c]^o[l]^a[f]^n[y],e[8]=n[h]^i[p]^o[g]^a[d],e[9]=a[h]^n[p]^i[g]^o[d],e[10]=o[h]^a[p]^n[g]^i[d],e[11]=i[h]^o[p]^a[g]^n[d],e[12]=n[m]^i[v]^o[w]^a[b],e[13]=a[m]^n[v]^i[w]^o[b],e[14]=o[m]^a[v]^n[w]^i[b],e[15]=i[m]^o[v]^a[w]^n[b]},b=function(e,r){return[e[0]^r[0],e[1]^r[1],e[2]^r[2],e[3]^r[3]]},k=function(e,r,t){for(var n=0;n<e.length;n+=1)e[n]^=r[n+t]},E=function(e){var r=e[0];e[0]=e[1],e[1]=e[2],e[2]=e[3],e[3]=r},x=function(e){for(var r=0;r<e.length;r+=1)e[r]=u[e[r]]},A=function(e){for(var r=0;r<e.length;r+=1)e[r]=s[e[r]]},S=function(e,r){return[e[4*r],e[4*r+1],e[4*r+2],e[4*r+3]]};return g=function(e){for(var r,t,n,o,i,a=[],u=0;u<4*h;)a.push(e[u++]);for(u=h;u<4*(p+1);){if(r=S(a,u-1),u%h===0){var s=[c[u/h],0,0,0];E(r),x(r),r=b(r,s)}else h>6&&u%h===4&&x(r);var l=b(S(a,u-h),r);n=l,i=0,(t=a)[4*(o=u)]=n[4*i],t[4*o+1]=n[4*i+1],t[4*o+2]=n[4*i+2],t[4*o+3]=n[4*i+3],u+=1}return a}(l),{encrypt:function(e){var r,t=e;for(k(t,g,0),r=1;r<=p-1;r+=1)x(t),d(t),v(t),k(t,g,4*r*4);return x(t),d(t),k(t,g,4*p*4),t},decrypt:function(e){var r,t=e;for(k(t,g,4*p*4),r=p-1;r>=1;r-=1)m(t),A(t),k(t,g,4*r*4),w(t);return m(t),A(t),k(t,g,0),t},clear:function(){},keyLength:f,blockSize:128}}}}(),C=C||{};C.pkcsv7=function(e){return{pad:function(r){var t=r[r.length-1>=0?r.length-1:0],n=t.length;if(n===e){var o,i=[];for(o=0;o<e;o+=1)i.push(e);r.push(i)}else for(var a=e-n&255;t.length!==e;)t.push(a)},unpad:function(r){var t=!0;r.length%e!==0&&(t=!1);for(var n=r.slice(-e),o=n[n.length-1],i=0;i<e;i++){var a=e-i<=o,u=n[i]===o;t=(!a||u)&&t}var s=t?o:0;return r.length-=s,t}}};var H=function(e){var r=e.blockSize/8,t=C.pkcsv7(r),n=function(e){var r,t,n=[];for(r=0;r<e.length;r+=1){var o=e[r];for(t=0;t<o.length;t+=1)n.push(o[t])}return n};function o(e){var t=[];s=s.concat(e);for(var n=Math.floor(s.length/r),o=0;o<n;o++)t.push(s.slice(o*r,(o+1)*r));return s=s.slice(n*r),t}function i(r){for(var t,n=[],o=0;o<r.length;o++)t=y.xorVectors(u,r[o]),n.push(e.encrypt(t)),u=n[o];return n}function a(){s=[],c=[],u=null}var u,s=[],c=[];return{init:function(e){if(e.length!==r)throw new Error("Invalid iv size");u=e.slice()},encrypt:function(e){var r=i(o(e));return c=c.concat(n(r)),this.finishEncrypt()},processEncrypt:function(e){return n(i(o(e)))},finishEncrypt:function(){var e=1===s.length?[[s[0]]]:[s];t.pad(e);var r=c.concat(n(i(e)));return a(),r},decrypt:function(e){return this.processDecrypt(e),this.finishDecrypt()},processDecrypt:function(r){var t=function(r){for(var t,n,o=[],i=0;i<r.length;i+=1)t=r[i].slice(0,r[i].length),n=e.decrypt(t),o.push(y.xorVectors(u,n)),u=r[i];return o}(o(r));c=c.concat(n(t))},finishDecrypt:function(){var e=c;t.unpad(e);return a(),e}}};if("undefined"!==typeof r){var P={};H.workerEncrypt=function(e){var r,t=e.workerid;return P[t]||(P[t]=H(I.aes(e.keyData)),P[t].init(e.algorithm.iv)),"process"===e.operationSubType?P[t].processEncrypt(e.buffer):"finish"===e.operationSubType?(r=P[t].finishEncrypt(),P[t]=null,r):(r=P[t].encrypt(e.buffer),P[t]=null,r)},H.workerDecrypt=function(e){var r,t=e.workerid;if(P[t]||(P[t]=H(I.aes(e.keyData)),P[t].init(e.algorithm.iv)),"process"!==e.operationSubType)return"finish"===e.operationSubType?(r=P[t].finishDecrypt(),P[t]=null,r):(r=P[t].decrypt(e.buffer),P[t]=null,r);P[t].processDecrypt(e.buffer)},H.generateKey=function(e){if(e.algorithm.length%8!==0)throw new Error;return{type:"keyGeneration",keyData:z.getBytes(Math.floor(e.algorithm.length/8)),keyHandle:{algorithm:e.algorithm,extractable:e.extractable,usages:e.usages,type:"secret"}}},H.importKey=function(e){var r,t=8*e.keyData.length;if("jwk"===e.format)r=g.jwkToKey(e.keyData,e.algorithm,["k"]);else{if("raw"!==e.format)throw new Error("unsupported import format");if(128!==t&&192!==t&&256!==t)throw new Error("invalid key length (should be 128, 192, or 256 bits)");r={k:y.toArray(e.keyData)}}return e.algorithm.length=8*r.k.length,{keyData:r.k,keyHandle:{algorithm:e.algorithm,extractable:e.extractable||r.extractable,usages:e.usages,type:"secret"},type:"keyImport"}},H.exportKey=function(e){if("jwk"===e.format)return{type:"keyExport",keyHandle:g.keyToJwk(e.keyHandle,e.keyData)};if("raw"===e.format)return{type:"keyExport",keyHandle:e.keyData};throw new Error("unsupported export format")},r.register("importKey","AES-CBC",H.importKey),r.register("exportKey","AES-CBC",H.exportKey),r.register("generateKey","AES-CBC",H.generateKey),r.register("encrypt","AES-CBC",H.workerEncrypt),r.register("decrypt","AES-CBC",H.workerDecrypt)}var B=function(e){var r,t,n,o,i,a,u=y,s=[],c=e.encrypt(u.getVector(16)),l=u.getVector(16),f=[],h=[],p=0;function g(e,r){for(var t,n=Math.floor(r.length/16),o=0;o<n;o++)t=r.slice(16*o,16*o+16),l=m(u.xorVectors(l,t),e);return f=r.slice(16*n),l}function d(){var e=16*Math.ceil(p/16)-p,r=E(8*t.length),n=E(8*p),o=f.concat(u.getVector(e)).concat(r).concat(n);return g(c,o)}function m(e,r){var t,n,o,i=u.getVector(16),a=r.slice(0);for(o=0;o<128;o++){for(t=255&-w(e,o),n=0;n<16;n++)i[n]=i[n]^a[n]&t;t=255&-(1&a[15]),v(a),a[0]^=225&t}return i}function v(e){for(var r=e.length-1;r>0;r--)e[r]=(1&e[r-1])<<7|e[r]>>>1;return e[0]=e[0]>>>1,e}function w(e,r){return e[Math.floor(r/8)]>>7-r%8&1}function b(e){for(var r=256,t=1;t<=4;t++)r=(r>>>8)+e[e.length-t],e[e.length-t]=255&r;return e}function k(r,t){var n,o=Math.ceil(t.length/16),i=[];a!==r&&(a=r.slice());for(var s=0;s<o;s++){n=t.slice(16*s,16*s+16);var c=e.encrypt(a.slice());i=i.concat(u.xorVectors(n,c)),a=b(a)}return i}function E(e){return[0,0,0,0,e>>>24&255,e>>>16&255,e>>>8&255,255&e]}function x(){p=0,s=[],h=[],l=u.getVector(16),f=[],a=r=t=null}return{init:function(e,a,s){if(t=a||[],(n=isNaN(s)?128:s)%8!==0)throw new Error("DataError");if(12===(r=e).length)o=r.concat([0,0,0,1]);else{var f=16*Math.ceil(r.length/16)-r.length;o=g(c,r.concat(u.getVector(f+8)).concat(E(8*r.length))),l=u.getVector(16)}i=b(o.slice()),g(c,function(e){var r=16*Math.ceil(t.length/16)-t.length;return e.concat(u.getVector(r))}(t))},encrypt:function(e){p=e.length;var r=k(i,e);g(c,r);var t=d(),a=k(o,t).slice(0,n/8);return x(),r.slice().concat(a)},decrypt:function(e,r){p=e.length;var t=k(i,e);g(c,e);var a=d(),s=k(o,a).slice(0,n/8);return x(),u.arraysEqual(s,r)?t:null},processEncrypt:function(e){var r=(s=s.concat(e)).slice(0,16*Math.floor(s.length/16));p+=r.length,s=s.slice(r.length);var t=k(a||i,r);h=h.concat(t),g(c,t)},processDecrypt:function(e){var r=(s=s.concat(e)).slice(0,16*Math.floor((s.length-n/8)/16));p+=r.length,s=s.slice(r.length);var t=k(a||i,r);h=h.concat(t),g(c,r)},finishEncrypt:function(){var e=k(a,s);h=h.concat(e),p+=s.length;var r=d(),t=k(o,r).slice(0,n/8),i=h.slice().concat(t);return x(),i},finishDecrypt:function(){var e=Math.floor(n/8),r=s.slice(-e);s=s.slice(0,s.length-e);var t=k(a,s);h=h.concat(t),p+=s.length;var i=d(),c=k(o,i).slice(0,n/8),l=h.slice();return x(),u.arraysEqual(c,r)?l:null}}};if("undefined"!==typeof r){var F={};B.encrypt=function(e){var r,t=e.workerid;if(F[t]||(F[t]=B(I.aes(e.keyData)),F[t].init(e.algorithm.iv,e.algorithm.additionalData,e.algorithm.tagLength)),"process"!==e.operationSubType)return"finish"===e.operationSubType?(r=F[t].finishEncrypt(),F[t]=null,r):(r=F[t].encrypt(e.buffer),F[t]=null,r);F[t].processEncrypt(e.buffer)},B.decrypt=function(e){var r,t=e.workerid;if(F[t]||(F[t]=B(I.aes(e.keyData)),F[t].init(e.algorithm.iv,e.algorithm.additionalData,e.algorithm.tagLength)),"process"!==e.operationSubType){if("finish"===e.operationSubType){if(r=F[t].finishDecrypt(),F[t]=null,null===r)throw new Error("OperationError");return r}var n=e.algorithm.tagLength?Math.floor(e.algorithm.tagLength/8):16,o=e.buffer.slice(0,e.buffer.length-n),i=e.buffer.slice(-n);if(r=F[t].decrypt(o,i),F[t]=null,null===r)throw new Error("OperationError");return r}F[t].processDecrypt(e.buffer)},B.generateKey=function(e){if(e.algorithm.length%8!==0)throw new Error;return{type:"keyGeneration",keyData:z.getBytes(Math.floor(e.algorithm.length/8)),keyHandle:{algorithm:e.algorithm,extractable:e.extractable,usages:e.usages,type:"secret"}}},B.importKey=function(e){var r,t=8*e.keyData.length;if("jwk"===e.format)r=g.jwkToKey(e.keyData,e.algorithm,["k"]);else{if("raw"!==e.format)throw new Error("unsupported import format");if(128!==t&&192!==t&&256!==t)throw new Error("invalid key length (should be 128, 192, or 256 bits)");r={k:y.toArray(e.keyData)}}return{type:"keyImport",keyData:r.k,keyHandle:{algorithm:e.algorithm,extractable:e.extractable||r.extractable,usages:e.usages,type:"secret"}}},B.exportKey=function(e){if("jwk"===e.format)return{type:"keyExport",keyHandle:g.keyToJwk(e.keyHandle,e.keyData)};if("raw"===e.format)return{type:"keyExport",keyHandle:e.keyData};throw new Error("unsupported export format")},r.register("importKey","AES-GCM",B.importKey),r.register("exportKey","AES-GCM",B.exportKey),r.register("generateKey","AES-GCM",B.generateKey),r.register("encrypt","AES-GCM",B.encrypt),r.register("decrypt","AES-GCM",B.decrypt)}function R(){if(!(this instanceof R))throw new Error("create MsrcryptoPrng object with new keyword");var e,r,t,n,o=!1,i=1,a=Math.pow(2,48);function u(e){var r;for(r=e.length-1;r>=0&&(e[r]+=1,e[r]>=256&&(e[r]=0),!e[r]);r-=1);}function s(){e=y.getVector(32),r=y.getVector(16),t=32,n=48,i=1}function c(e,r){if((r=r||[0]).length>n)throw new Error("Incorrect entropy or additionalEntropy length");r=r.concat(y.getVector(n-r.length)),e=e.concat(y.getVector((n-e.length%n)%n));for(var t=0;t<e.length;t+=n){l(y.xorVectors(e.slice(t,t+n),r))}i=1}function l(o){for(var i=[],a=new I.aes(e);i.length<n;){u(r);var s=r.slice(0,16),c=a.encrypt(s);i=i.concat(c)}i=y.xorVectors(i,o),e=i.slice(0,t),r=i.slice(t)}function f(t,o){if(t>=65536)throw new Error("too much random requested");if(i>a)throw new Error("Reseeding is required");if(o&&o.length>0){for(;o.length<n;)o=o.concat(y.getVector(n-o.length));l(o)}else o=y.getVector(n);for(var s=[],c=new I.aes(e);s.length<t;){u(r);var f=r.slice(0,r.length),h=c.encrypt(f);s=s.concat(h)}return s=s.slice(0,t),l(o),i+=1,s}return s(),{reseed:c,getBytes:function(e,r){if(!o)throw new Error("can't get randomness before initialization");return f(e,r)},getNonZeroBytes:function(e,r){if(!o)throw new Error("can't get randomness before initialization");for(var t,n=[];n.length<e;){t=f(e,r);for(var i=0;i<t.length;i+=1)0!==t[i]&&n.push(t[i])}return n.slice(0,e)},init:function(e,r){if(e.length<n)throw new Error("Initial entropy length too short");s(),c(e,r),o=!0}}}var z=new R;var U,q=function(){var e=[],r=[];function t(t){var n,o=r.length;for(n=0;n<o;n++)if((r[n]+t)%e[n]===0)return!1;return!0}function n(t){var n,o,i,a,u,s,c=t.length-1,l=d.DIGIT_BASE,f=t[c];for(0===e.length&&(e=function(e){var r,t,n=new Array(e+1),o=[],i=0|Math.sqrt(e);for(r=3;r<=i;r+=2)for(t=r*r;t<=e;t+=2*r)n[t]=0;for(r=3;r<=e;r+=2)0!==n[r]&&o.push(r);return o}(16384)),s=e.length,r=new Array(s),n=0;n<s;n++){for(o=c,f<(u=e[n])?(i=f,o--):i=0;o>=0;)i=(a=i*l+t[o--])-(a/u|0)*u;r[n]=i}}function o(e,r){var t=e,n=[];d.subtract(t,[1],n);var o=function(e){var r,t=0,n=0;if(d.isZero(e))return 0;for(t=0;0===e[t];t++);for(n=0,r=2;e[t]%r===0;r*=2,n++);return t*d.DIGIT_BITS+n}(n),a=[];d.shiftRight(n,a,o);for(var u,s=function(e){var r=0,t=0,n=0;if(d.isZero(e))return 0;for(r=e.length-1;0===e[r];r--);for(n=1<<(t=d.DIGIT_BITS-1);t>0&&0===(e[r]&n);n>>>=1,t--);return r*d.DIGIT_BITS+t}(t),c=d.MontgomeryMultiplier(t),l=1;l<=r;l++){var f=!1;do{u=i(s)}while(d.compareDigits(u,n)>=0);var y=[];if(c.modExp(u,a,y,!0),0!==d.compareDigits(y,[1])&&0!==d.compareDigits(y,n)){for(var h=1;h<o;h++){if(c.montgomeryMultiply(y,y,y),0===d.compareDigits(y,n)){f=!0;break}if(0===d.compareDigits(y,[1]))return!1}if(!1===f)return!1}}return!0}function i(e){var r=Math.ceil(e/8),t=z.getBytes(r);return t[0]|=128,t[t.length-1]|=1,d.bytesToDigits(t)}return{generatePrime:function(e){var r=i(e),a=0,u=[];for(n(r);;){if(t(a)&&(d.add(r,[a],u),!0===o(u,6)))return u;a+=2}}}}(),N=function(e){var r=y,t=e.hasOwnProperty("n")&&e.hasOwnProperty("d"),n=e.hasOwnProperty("p")&&e.hasOwnProperty("q"),o=e.n.length;function i(e){var t=d.digitsToBytes(e);return r.padFront(t,0,o),t}function a(e,r,t){var n=d.bytesToDigits(r),o=d.IntegerGroup(t),i=o.createElementFromBytes(e);return o.modexp(i,n).m_digits}return{encrypt:function(r){return i(a(r,e.e,e.n))},decrypt:function(r){if(n)return function(r){var t=d.bytesToDigits,n=e.p,o=e.q,a=e.dp,u=e.dq,s=e.qi,c=t(n),l=t(o),f=new Array(c.length+l.length),y=new Array(c.length+1),h=new Array(l.length+1),p=t(r),g=d.MontgomeryMultiplier,m=new g(e.ctxp?void 0:c,e.ctxp),v=new g(e.ctxq?void 0:l,e.ctxq);m.reduce(p,f),m.modExp(f,t(a),y),v.reduce(p,f),v.modExp(f,t(u),h);var w=d.subtract(y,h,f);return 0!==w&&d.subtract(h,y,f),d.modMul(f,t(s),c,p),0!==w&&d.subtract(c,p,p),d.multiply(p,l,f),d.add(h,f,y),i(y)}(r);if(t)return function(r){return i(a(r,e.d,e.n))}(r);throw new Error("missing private key")}}},O=function(e,r,t){var n,o,i,a=[],u=t.hashLen/8;for(i=0;i<=Math.floor(r/u);i+=1)n=[i>>>24&255,i>>>16&255,i>>>8&255,255&i],o=t.computeHash(e.concat(n)),a=a.concat(o);return a.slice(0,r)};(U=U||{}).oaep=function(e,r){var t=y,n=z,o=e.n.length;if(null===r)throw new Error("must supply hashFunction");return{pad:function(e,i){return function(e,i){var a,u,s,c,l,f,y,h,p;if(e.length>o-r.hashLen/8*2-2)throw new Error("Message too long.");return null==i&&(i=[]),a=r.computeHash(i),u=o-e.length-2*a.length-2,s=t.getVector(u),c=a.concat(s,[1],e),l=n.getBytes(a.length),f=O(l,o-a.length-1,r),y=t.xorVectors(c,f),h=O(y,a.length,r),p=t.xorVectors(l,h),[0].concat(p).concat(y).slice()}(e,i)},unpad:function(e,n){return function(e,n){var i,a,u,s,c,l,f,y,h=0,p=0===e[0];for(n||(n=[]),i=r.computeHash(n),a=e.slice(1,i.length+1),u=e.slice(i.length+1),s=O(u,i.length,r),c=t.xorVectors(a,s),l=O(c,o-i.length-1,r),y=(f=t.xorVectors(u,l)).slice(0,i.length),p=p&&t.arraysEqual(i,y),f=f.slice(i.length);!f[h++];);return{valid:p,data:f.slice(h)}}(e,n)}}},(U=U||{}).pkcs1Encrypt=function(e){var r=z,t=e.n.length;return{pad:function(e){return function(e){var n;if(e.length>t-11)throw new Error("message too long");return n=r.getNonZeroBytes(t-e.length-3),[0,2].concat(n,[0],e)}(e)},unpad:function(e){return function(e){var r,t=function(e){for(var r=0===e[0]&&2===e[1],t=2;t<10;t++)r=r&&!!e[t];return r}(e),n=0;for(r=1;r<e.length;r+=1)n=n||+!e[r]&&r+1;return n=-t&&n,{data:e.slice(n),valid:t}}(e)}}},U.pkcs1Sign=function(e,r){var t=y,n=e.n.length;function o(e){var o,i,a;if(i=r.computeHash(e.slice()),a=(o=r.der.concat(i)).length,n<a+11)throw new Error("intended encoded message length too short");return[0,1].concat(t.getVector(n-a-3,255),[0],o)}return{sign:function(e){return o(e)},verify:function(e,r){var n=o(r);return t.arraysEqual(e,n)}}},(U=U||{}).pss=function(e,r){var t=y,n=z;return{sign:function(o,i,a){return function(o,i,a){var u=d.bitLength(e.n)-1,s=Math.ceil(u/8),c=r.computeHash(o);if(i=a?a.length:null==i?c.length:i,s<c.length+i+2)throw new Error("encoding error");a=a||n.getBytes(i);for(var l=[0,0,0,0,0,0,0,0].concat(c,a),f=r.computeHash(l),y=t.getVector(s-a.length-f.length-2).concat([1],a),h=O(f,s-f.length-1,r),p=t.xorVectors(y,h),g=0,m=0;m<8-(8*s-u);m++)g+=1<<m;return p[0]&=g,p.concat(f,[188])}(o,i,a)},verify:function(n,o,i){return function(n,o,i){var a=d.bitLength(e.n)-1,u=Math.ceil(a/8),s=r.computeHash(o),c=s.length;if(u<c+(i=null==i?c:i)+2)return!1;var l=n.slice(0,u-c-1),f=n.slice(l.length,l.length+c),y=O(f,u-c-1,r),h=t.xorVectors(l,y);h[0]&=255>>>8-(8*u-a);for(var p=0;p<u-c-i-2;p++)if(0!==h[p])return!1;if(1!==h[u-c-i-2])return!1;var g=h.slice(h.length-i),m=[0,0,0,0,0,0,0,0].concat(s,g),v=r.computeHash(m);return t.arraysEqual(v,f)}(n,o,i)}}};var j=function(e,r,t){var n=N(e);if(!r)throw new Error("padding mode");function o(){if(!t||!t.computeHash)throw new Error("missing hash function")}var i,a=null,u=null;switch(r){case"RSAES-PKCS1-V1_5":i=U.pkcs1Encrypt(e);break;case"RSASSA-PKCS1-V1_5":o(),i=U.pkcs1Sign(e,t);break;case"RSA-OAEP":o(),i=U.oaep(e,t);break;case"RSA-PSS":o(),i=U.pss(e,t);break;case"raw":i={pad:function(e){return e},unpad:function(e){return e}};break;default:throw new Error("invalid mode")}return i&&(a=i.pad||i.sign,u=i.unpad||i.verify),{encrypt:function(e,r){var t;return t=null!==a?a(e,r):e.slice(),n.encrypt(t)},decrypt:function(e,r){var t=n.decrypt(e);if(null!==u){if(!1===(t=u(t,r)).valid)throw new Error("OperationError");t=t.data}else t=t.slice(0);return t},signData:function(e,r,t){return n.decrypt(a(e,r,t))},verifySignature:function(e,r,t){var o=n.encrypt(e);return u(o,r,t)},generateKeyPair:function(e){genRsaKeyFromRandom(e)},mode:r}};"undefined"!==typeof r&&(j.sign=function(e){var r=e.keyHandle.algorithm.hash.name,t=f[r.toUpperCase()](),n=e.algorithm.saltLength,o=e.algorithm.salt;return j(e.keyData,e.algorithm.name,t).signData(e.buffer,n,o)},j.verify=function(e){var r=e.keyHandle.algorithm.hash.name,t=f[r.toUpperCase()](),n=e.algorithm.saltLength;return j(e.keyData,e.algorithm.name,t).verifySignature(e.signature,e.buffer,n)},j.workerEncrypt=function(e){var r,t,n;switch(e.algorithm.name){case"RSAES-PKCS1-V1_5":r=j(e.keyData,e.algorithm.name).encrypt(e.buffer);break;case"RSA-OAEP":if(!(n=e.keyHandle.algorithm.hash.name))throw new Error("unsupported hash algorithm");t=f[n.toUpperCase()](),r=j(e.keyData,e.algorithm.name,t).encrypt(e.buffer);break;default:throw new Error("unsupported algorithm")}return r},j.workerDecrypt=function(e){var r,t;switch(e.algorithm.name){case"RSAES-PKCS1-V1_5":r=j(e.keyData,e.algorithm.name).decrypt(e.buffer);break;case"RSA-OAEP":var n=e.keyHandle.algorithm.hash.name;if(!n)throw new Error("unsupported hash algorithm");t=f[n.toUpperCase()](),r=j(e.keyData,e.algorithm.name,t).decrypt(e.buffer);break;default:throw new Error("unsupported algorithm")}return r},j.importKey=function(e){var r;if("jwk"===e.format)(r=g.jwkToKey(e.keyData,e.algorithm,["n","e","d","q","p","dq","dp","qi"])).d&&(r.ctxp=new d.MontgomeryMultiplier(d.bytesToDigits(r.p)).ctx,r.ctxq=new d.MontgomeryMultiplier(d.bytesToDigits(r.q)).ctx);else{if("spki"!==e.format)throw new Error("unsupported key import format.");var t=h.parse(e.keyData);if(null==t)throw new Error("invalid key data.");var n=t[1],o=h.parse(n.data.slice(n.header+1),!0);if(null==o)throw new Error("invalid key data.");var i=o[0],a=o[1];if("INTEGER"!==i.type||"INTEGER"!==a.type)throw new Error("invalid key data.");i=i.data.slice(i.header),a=a.data.slice(a.header),0===i[0]&&128&i[1]&&(i=i.slice(1)),0===a[0]&&128&a[1]&&(a=a.slice(1)),r={n:i,e:a}}return{type:"keyImport",keyData:r,keyHandle:{algorithm:e.algorithm,extractable:e.extractable,usages:e.usages,type:r.d||r.dq?"private":"public"}}},j.exportKey=function(e){return{type:"keyExport",keyHandle:g.keyToJwk(e.keyHandle,e.keyData)}},j.genRsaKeyFromRandom=function(e,r){var t=r?d.bytesToDigits(r):[65537];do{var n=q.generatePrime(e/2),o=q.generatePrime(e/2);if(d.compareDigits(o,n)>0){var i=n;n=o,o=i}var a=[];d.multiply(n,o,a);var u=[];d.subtract(n,[1],u);var s=[];d.subtract(o,[1],s);var c=[];d.multiply(u,s,c);var l=[];d.gcd(t,c,l);var f=0===d.compareDigits(l,d.One)}while(!f);var y=[];d.modInv(t,c,y);var h=[];d.reduce(y,u,h);var p=[];d.reduce(y,s,p);var g=[];d.modInv(o,n,g);var m=d.digitsToBytes;return{privateKey:{n:m(a),e:m(t),d:m(y),p:m(n),q:m(o),dp:m(h),dq:m(p),qi:m(g)},publicKey:{n:m(a),e:m(t)}}},j.generateKeyPair=function(e){if("undefined"===typeof e.algorithm.modulusLength)throw new Error("missing modulusLength");var r,t=d.bytesToDigits;switch(e.algorithm.modulusLength){case 1024:case 2048:case 4096:r=j.genRsaKeyFromRandom(e.algorithm.modulusLength,e.algorithm.publicExponent);break;default:throw new Error("invalid modulusLength")}var n=r.privateKey;n.ctxp=new d.MontgomeryMultiplier(t(n.p)).ctx,n.ctxq=new d.MontgomeryMultiplier(t(n.q)).ctx;var o,i,a=e.algorithm.name;a.slice(a.indexOf("-")+1).toUpperCase();return"RSASSA-PKCS1-V1_5"===a||"RSA-PSS"===a?(o=["verify"],i=["sign"]):(o=["encrypt"],i=["decrypt"]),{type:"keyGeneration",keyPair:{publicKey:{keyData:r.publicKey,keyHandle:{algorithm:e.algorithm,extractable:e.extractable,usages:o,type:"public"}},privateKey:{keyData:r.privateKey,keyHandle:{algorithm:e.algorithm,extractable:e.extractable,usages:i,type:"private"}}}}},r.register("sign","RSASSA-PKCS1-V1_5",j.sign),r.register("sign","RSA-PSS",j.sign),r.register("verify","RSASSA-PKCS1-V1_5",j.verify),r.register("verify","RSA-PSS",j.verify),r.register("encrypt","RSAES-PKCS1-V1_5",j.workerEncrypt),r.register("decrypt","RSAES-PKCS1-V1_5",j.workerDecrypt),r.register("encrypt","RSA-OAEP",j.workerEncrypt),r.register("decrypt","RSA-OAEP",j.workerDecrypt),r.register("importKey","RSA-OAEP",j.importKey),r.register("importKey","RSAES-PKCS1-V1_5",j.importKey),r.register("importKey","RSASSA-PKCS1-V1_5",j.importKey),r.register("importKey","RSA-PSS",j.importKey),r.register("exportKey","RSA-OAEP",j.exportKey),r.register("exportKey","RSAES-PKCS1-V1_5",j.exportKey),r.register("exportKey","RSASSA-PKCS1-V1_5",j.exportKey),r.register("exportKey","RSA-PSS",j.exportKey),r.register("generateKey","RSA-OAEP",j.generateKeyPair),r.register("generateKey","RSAES-PKCS1-V1_5",j.generateKeyPair),r.register("generateKey","RSASSA-PKCS1-V1_5",j.generateKeyPair),r.register("generateKey","RSA-PSS",j.generateKeyPair));var L={deriveBits:function(e){for(var r=e.algorithm.hash.name,t=f[r.toUpperCase()](),n=e.algorithm,o=Y.toArray(n.algorithmId).concat(Y.toArray(n.partyUInfo),Y.toArray(n.partyVInfo),Y.toArray(n.publicInfo)||[],Y.toArray(n.privateInfo)||[]),i=Math.ceil(e.length/t.hashLen),a=1,u=e.keyData.concat(o),s=[],c=0;c<i;c++){var l=Y.int32ToBytes(a++).concat(u),y=t.computeHash(l);s=s.concat(y)}return s.slice(0,e.length/8)}};"undefined"!==typeof r&&(L.importKey=function(e){var r;if("raw"!==e.format)throw new Error("unsupported import format");if(r=y.toArray(e.keyData),!1!==e.extractable)throw new Error("only extractable=false is supported.");return{type:"keyImport",keyData:r,keyHandle:{algorithm:{name:"CONCAT"},extractable:!1,usages:e.usages,type:"secret"}}},r.register("deriveBits","CONCAT",L.deriveBits),r.register("importKey","CONCAT",L.importKey));var W={deriveBits:function(e){var r,t,n=e.algorithm,o=e.keyData,i=e.length,a=n.iterations,u=Array.apply(null,n.salt),s=Math.ceil(i/8),c=[];switch(n.hash.name.toUpperCase()){case"SHA-1":r=20;break;case"SHA-256":r=32;break;case"SHA-384":r=48;break;case"SHA-512":r=64;break;default:throw new Error("Unsupported hash algorithm")}t=Math.ceil(s/r);var l=T.importKey({format:"raw",keyData:o,algorithm:{name:"HMAC",hash:n.hash}}),f={algorithm:n,keyHandle:l.keyHandle,keyData:l.keyData,workerid:0,buffer:null};function y(e,t,n){for(var o=[],i=e.concat([n>>>24&255,n>>>16&255,n>>>8&255,255&n]),a=0;a<t;a++){f.buffer=i,i=T.signHmac(f);for(var u=0;u<r;u++)o[u]=o[u]^i[u]}return o}for(var h=1;h<=t;h++)c=c.concat(y(u,a,h));return c.length=s,c}};"undefined"!==typeof r&&(W.importKey=function(e){var r;if("raw"!==e.format)throw new Error("unsupported import format");if(r=y.toArray(e.keyData),!1!==e.extractable)throw new Error("only extractable=false is supported.");return{type:"keyImport",keyData:r,keyHandle:{algorithm:{name:"PBKDF2"},extractable:!1,usages:e.usages,type:"secret"}}},r.register("deriveBits","PBKDF2",W.deriveBits),r.register("importKey","PBKDF2",W.importKey));var V={deriveBits:function(e){var r,t,n,o=e.algorithm,i=e.keyData,a=e.length,u=o.salt,s=Math.ceil(a/8),c=[],l=y.toArray(o.info),f=[];switch(o.hash.name.toUpperCase()){case"SHA-1":r=20;break;case"SHA-256":r=32;break;case"SHA-384":r=48;break;case"SHA-512":r=64;break;default:throw new Error("Unsupported hash algorithm.")}if(null==o.salt)throw new Error("HkdfParams: salt: Missing required property.");if(null==o.info)throw new Error("HkdfParams: info: Missing required property.");if(a%8!==0)throw new Error("The length provided for HKDF is not a multiple of 8 bits.");if(s>255*r)throw new Error("The length provided for HKDF is too large.");for(0===u.length&&(u=y.getVector(r)),(n={workerid:0,keyHandle:{algorithm:o},keyData:u,buffer:i}).keyData=T.signHmac(n),t=0;t<Math.ceil(s/r);t++)n.buffer=f.concat(l).concat([1+t]),f=T.signHmac(n),c=c.concat(f);return c.slice(0,s)}};"undefined"!==typeof r&&(V.importKey=function(e){var r;if("raw"!==e.format)throw new Error("unsupported import format");if(r=y.toArray(e.keyData),!1!==e.extractable)throw new Error("only extractable=false is supported.");return{type:"keyImport",keyData:r,keyHandle:{algorithm:{name:"HKDF"},extractable:!1,usages:e.usages,type:"secret"}}},r.register("deriveBits","HKDF",V.deriveBits),r.register("importKey","HKDF",V.importKey));var G={deriveBits:function(e){var r,t,n,o=e.algorithm,i=e.keyData,a=e.length,u=o.label,s=o.context,c=Math.ceil(a/8),l=[];switch(o.hash.name.toUpperCase()){case"SHA-1":r=20;break;case"SHA-256":r=32;break;case"SHA-384":r=48;break;case"SHA-512":r=64;break;default:throw new Error("Unsupported hash algorithm.")}if(null==o.label)throw new Error("HkdfCtrParams: label: Missing required property.");if(null==o.context)throw new Error("HkdfCtrParams: context: Missing required property.");if(a%8!==0)throw new Error("The length provided for HKDF-CTR is not a multiple of 8 bits.");if(c>255*r)throw new Error("The length provided for HKDF-CTR is too large.");n={workerid:0,keyHandle:{algorithm:o},keyData:i,buffer:i};var f=u.concat([0],s,Y.int32ToBytes(a));for(t=1;t<=Math.ceil(c/r);t++)n.buffer=Y.int32ToBytes(t).concat(f),l=l.concat(T.signHmac(n));return l.slice(0,c)}};"undefined"!==typeof r&&(G.importKey=function(e){var r;if("raw"!==e.format)throw new Error("unsupported import format");if(r=y.toArray(e.keyData),!1!==e.extractable)throw new Error("only extractable=false is supported.");return{type:"keyImport",keyData:r,keyHandle:{algorithm:{name:"HKDF-CTR"},extractable:!1,usages:e.usages,type:"secret"}}},r.register("deriveBits","HKDF-CTR",G.deriveBits),r.register("importKey","HKDF-CTR",G.importKey));var Z=function(e){var r=d.bytesToDigits,t=d.digitsToBytes,n=e,o=new m.EllipticCurveOperatorFp(e);return{generateKey:function(r){var i=[],a=z.getBytes(e.order.length*d.DIGIT_NUM_BYTES);d.reduce(d.bytesToDigits(a),n.order,i);var u=n.allocatePointStorage();return o.scalarMultiply(i,n.generator,u),{privateKey:{x:t(u.x),y:t(u.y),d:t(i)},publicKey:{x:t(u.x),y:t(u.y)}}},deriveBits:function(e,t,i){var a=new m.EllipticCurvePointFp(n,!1,r(t.x),r(t.y),null,!1),u=n.allocatePointStorage();o.convertToJacobianForm(u),o.convertToMontgomeryForm(u),o.scalarMultiply(r(e.d),a,u),o.convertToAffineForm(u),o.convertToStandardForm(u);var s=d.digitsToBytes(u.x,!0,t.x.length);if(i&&8*s.length<i)throw new Error("DataError");var c=i%8,l=0===c?255:65280>>>c;return(s=i?s.slice(0,Math.ceil(i/8)):s)[s.length-1]=s[s.length-1]&l,s},computePublicKey:function(e){n.generator.isInMontgomeryForm||o.convertToMontgomeryForm(n.generator);var i=n.allocatePointStorage();return o.convertToJacobianForm(i),o.convertToMontgomeryForm(i),o.scalarMultiply(r(e),n.generator,i),{x:t(i.x),y:t(i.y)}}}};"undefined"!==typeof r&&(Z.deriveBits=function(e){var r=m.createCurve(e.algorithm.namedCurve.toUpperCase()),t=e.keyData,n=e.additionalKeyData;return Z(r).deriveBits(t,n,e.length)},Z.deriveKey=function(e){throw new Error("not supported")},Z.generateKey=function(e){var r=m.createCurve(e.algorithm.namedCurve.toUpperCase()),t=Z(r).generateKey();return{type:"keyPairGeneration",keyPair:{publicKey:{keyData:t.publicKey,keyHandle:{algorithm:e.algorithm,extractable:e.extractable,usages:[],type:"public"}},privateKey:{keyData:t.privateKey,keyHandle:{algorithm:e.algorithm,extractable:e.extractable,usages:e.usages,type:"private"}}}}},Z.importKey=function(e){if("raw"===e.format){var r=e.keyData;if(4!==r[0])throw new Error("DataError");var t=~~((r.length-1)/2),n=e.algorithm.namedCurve.toUpperCase(),o=r.slice(1,t+1),i=r.slice(t+1);if(!1===m.validatePoint(n,o,i))throw new Error("DataError");return{type:"keyImport",keyData:{x:o,y:i},keyHandle:{algorithm:e.algorithm,extractable:e.extractable||!1,usages:e.usages,type:"public"}}}if("jwk"===e.format){var a=g.jwkToKey(e.keyData,e.algorithm,["x","y","d","crv"]);if(a.d&&(!a.x||!a.y)){var u=m.createCurve(e.algorithm.namedCurve.toUpperCase()),s=Z(u).computePublicKey(a.d);a.x=s.x,a.y=s.y}if(!1===m.validatePoint(e.algorithm.namedCurve.toUpperCase(),a.x,a.y))throw new Error("DataError");return{type:"keyImport",keyData:a,keyHandle:{algorithm:e.algorithm,extractable:e.extractable||a.extractable,usages:e.usages,type:a.d?"private":"public"}}}},Z.exportKey=function(e){if("raw"===e.format&&"public"===e.keyHandle.type)return{type:"keyExport",keyHandle:[4].concat(e.keyData.x,e.keyData.y)};if("jwk"===e.format)return{type:"keyExport",keyHandle:g.keyToJwk(e.keyHandle,e.keyData)};throw new Error("unsupported export format.")},r.register("importKey","ECDH",Z.importKey),r.register("exportKey","ECDH",Z.exportKey),r.register("generateKey","ECDH",Z.generateKey),r.register("deriveBits","ECDH",Z.deriveBits),r.register("deriveKey","ECDH",Z.deriveKey));var J,Q=function(e){var r=d.bytesToDigits,t=d.digitsToBytes,n=new m.EllipticCurveOperatorFp(e),o=t(e.order).length,i=1===e.type;function a(r){var t=e.allocatePointStorage();return n.scalarMultiply(r,e.generator,t),{publicKey:t,privateKey:r}}function u(r){var t=[];return r||(r=z.getBytes(e.order.length*d.DIGIT_NUM_BYTES)),d.reduce(d.bytesToDigits(r),e.order,t),a(t)}function s(t){t.length>o&&(t.length=o);var n=r(t);if(i){var a=8-e.rbits%8;d.shiftRight(n,n,a)}return d.reduce(n,e.order,n),n}return{createKey:function(e){return a(r(e))},generateKey:u,sign:function(n,i,a){a||(a=u());var c=a.publicKey.x,l=a.privateKey,f=r(n.d),h=s(i.slice()),p=[],g=[];d.reduce(c,e.order,c),d.modMul(c,f,e.order,p),d.add(p,h,p),d.reduce(p,e.order,p),d.modInvCT(l,e.order,g),d.modMul(p,g,e.order,p);var m=y.padFront(t(c,!0,o),0,o),v=y.padFront(t(p,!0,o),0,o);return m.concat(v)},verify:function(t,o,a){var u=Math.floor(o.length/2),c=r(o.slice(0,u)),l=r(o.slice(u)),f=s(a.slice()),y=[],h=[],p=new m.EllipticCurvePointFp(e,!1,r(t.x),r(t.y),null,!1);d.modInv(l,e.order,l),d.modMul(f,l,e.order,y),d.modMul(c,l,e.order,h);var g=e.allocatePointStorage(),v=e.allocatePointStorage();return i?(d.add(y,y,y),d.add(y,y,y),d.reduce(y,e.order,y),n.scalarMultiply(y,e.generator,g,!1),n.scalarMultiply(h,p,v,!1),n.convertToExtendedProjective(g),n.convertToExtendedProjective(v),n.add(v,g,g),n.normalize(g)):(n.scalarMultiply(y,e.generator,g),n.scalarMultiply(h,p,v),n.convertToJacobianForm(g),n.convertToMontgomeryForm(g),n.convertToMontgomeryForm(v),n.mixedAdd(g,v,g),n.convertToAffineForm(g),n.convertToStandardForm(g)),!g.isInfinity&&(d.reduce(g.x,e.order,g.x),0===d.compareDigits(g.x,c))}}};"undefined"!==typeof r&&(Q.sign=function(e){y.checkParam(e.algorithm.hash,"Object","algorithm.hash"),y.checkParam(e.algorithm.hash.name,"String","algorithm.hash.name"),y.checkParam(e.keyHandle.algorithm.namedCurve,"String","p.keyHandle.algorithm.namedCurve");var r=e.algorithm.hash.name,t=m.createCurve(e.keyHandle.algorithm.namedCurve.toUpperCase()),n=f[r.toUpperCase()]().computeHash(e.buffer);return Q(t).sign(e.keyData,n)},Q.verify=function(e){var r=e.algorithm.hash.name,t=m.createCurve(e.keyHandle.algorithm.namedCurve.toUpperCase()),n=f[r.toUpperCase()]().computeHash(e.buffer);return Q(t).verify(e.keyData,e.signature,n)},Q.generateKey=function(e){var r=m.createCurve(e.algorithm.namedCurve.toUpperCase()),t=Q(r).generateKey(),n=d.digitsToBytes;var o=n(t.publicKey.x),i=n(t.publicKey.y),a=n(t.privateKey);return{type:"keyPairGeneration",keyPair:{publicKey:{keyData:{x:o,y:i},keyHandle:{algorithm:e.algorithm,extractable:e.extractable,usages:["verify"],type:"public"}},privateKey:{keyData:{x:o,y:i,d:a},keyHandle:{algorithm:e.algorithm,extractable:e.extractable,usages:["sign"],type:"private"}}}}},Q.importKey=function(e){if("raw"===e.format){var r=e.keyData;if(4!==r[0])throw new Error("DataError");var t=~~((r.length-1)/2),n=e.algorithm.namedCurve.toUpperCase(),o=r.slice(1,t+1),i=r.slice(t+1);if(!1===m.validatePoint(n,o,i))throw new Error("DataError");return{type:"keyImport",keyData:{x:o,y:i},keyHandle:{algorithm:e.algorithm,extractable:e.extractable||!1,usages:e.usages,type:"public"}}}if("jwk"===e.format){var a=g.jwkToKey(e.keyData,e.algorithm,["x","y","d","crv"]);if(a.d&&(!a.x||!a.y)){var u=Q.curves[e.algorithm.namedCurve](),s=Q(u).computePublicKey(a.d);a.x=s.x,a.y=s.y}if(!1===m.validatePoint(e.algorithm.namedCurve.toUpperCase(),a.x,a.y))throw new Error("DataError");return{type:"keyImport",keyData:a,keyHandle:{algorithm:e.algorithm,extractable:e.extractable||a.extractable,usages:e.usages,type:a.d?"private":"public"}}}},Q.exportKey=function(e){if("raw"===e.format&&"public"===e.keyHandle.type)return{type:"keyExport",keyHandle:[4].concat(e.keyData.x,e.keyData.y)};if("jwk"===e.format)return{type:"keyExport",keyHandle:g.keyToJwk(e.keyHandle,e.keyData)};throw new Error("unsupported export format.")},r.register("sign","ECDSA",Q.sign),r.register("verify","ECDSA",Q.verify),r.register("generateKey","ECDSA",Q.generateKey),r.register("importKey","ECDSA",Q.importKey),r.register("exportKey","ECDSA",Q.exportKey));var Y=y;J=function(){function e(){var e;return{postMessage:function(r){try{r.workerid=this.id,e=p.jsCryptoRunner({data:r})}catch(t){return void this.onerror({data:t,type:"error"})}this.onmessage({data:e})},onmessage:null,onerror:null,terminate:function(){}}}function o(e){var r,t,n;return{dispatchEvent:function(o){"error"!==o.type?"process"!==o.data.type&&"finish"!==o.data.type?(this.result=e(o.data),t.apply(r,[this.result])):e(o.data.result,!0):n&&n.apply(r,[o])},promise:r=new Promise((function(e,r){t=e,n=r})),result:null}}function i(e){var r=[],t=o((function(e,t){var n;if(e=e&&(n=e,u&&n.pop?new Uint8Array(n).buffer:n),!t)return e;r.resolve(e)}));return t.stream=e.algorithm.stream,r.add=function(e){var t,n,o=new Promise((function(e,r){t=e,n=r}));return o.label=e,r.push({resolve:t,reject:n,promise:o}),o},r.resolve=function(e){var t=r.shift();t.resolve.apply(t.promise,[e])},t.process=function(t){return e.operationSubType="process",e.buffer=Y.toArray(t),s.continueJob(this,Y.clone(e)),r.add("process")},t.finish=function(){return e.operationSubType="finish",e.buffer=[],s.continueJob(this,Y.clone(e)),r.add("finish")},t.abort=function(){s.abortJob(this)},t.algorithm=e.algorithm||null,t.key=e.keyHandle||null,t}var a=[];a.add=function(e,r){a.push({keyHandle:e,keyData:r})},a.remove=function(e){for(var r=0;r<a.length;r+=1)if(a[r].keyHandle===e)return void(a=a.splice(r,1))},a.lookup=function(e){for(var r=0;r<a.length;r+=1)if(a[r].keyHandle===e)return a[r].keyData;return null};var s=function(){var r=[],o=[],i=0,a=0,u=[],s="undefined"===typeof setImmediate?setTimeout:setImmediate;function l(){u.shift()()}var f=n?"available":"unavailable";function y(){!function(e){for(var t=r.length-1;t>=0;t-=1)r[t].isWebWorker===e&&(r[t].terminate(),r.splice(t,1))}(!c);for(var e=0;e<r.length;e++)if(!r[e].busy)return r[e];return null}function h(e){for(var t=0;t<r.length;t++)if(r[t]===e)return e.terminate(),void r.splice(t,1)}function p(e){for(var t=0;t<r.length;t++)if(r[t].operation===e)return r[t];return null}function g(e,r){o.push({operation:e,data:r,id:i++})}function d(e){if(e.busy=!1,c)if(o.length>0){var t,n=o.shift();if(w(n.operation,n.data),"process"===n.data.operationSubType){for(t=0;t<o.length;t++)n.operation===o[t].operation&&w(o[t].operation,o[t].data);for(t=o.length-1;t>=0;t--)n.operation===o[t].operation&&o.splice(t,1)}}else(function(){for(var e=0,t=0;t<r.length;t++)r[t].busy||(e+=1);return e})()>2&&h(e)}function m(n){var i;if("pending"===f)throw new Error("Creating new worker while workerstatus=pending");if("ready"===f)try{(i=new Worker(t)).postMessage({prngSeed:z.getBytes(48)}),i.isWebWorker=!0}catch(u){c=!1,f="failed",i.terminate(),(i=e()).isWebWorker=!1}else(i=e()).isWebWorker=!1;return i.operation=n,i.id=a++,i.busy=!1,i.onmessage=function(e){if(!0!==e.data.initialized){var r=i.operation;e.target||(e.target={data:i.data});for(var t=0;t<o.length;t++)if(o[t].operation===i.operation){var n=o[t];return o.splice(t,1),void b(i,n.data)}e.data.hasOwnProperty("type")&&"process"===e.data.type||d(i),r.dispatchEvent(e)}},i.onerror=function(e){var r=i.operation;d(i),r.dispatchEvent(e)},function(e){r.push(e)}(i),i}function v(e,t){var n=null;if("pending"!==f)if(n=y(),c&&null===n&&r.length>=12)g(e,t);else{if(null===n&&(n=m(e)),null===n)throw g(e,t),new Error("could not create new worker");n.operation=e,n.busy=!0,t.workerid=n.id,b(n,t)}else g(e,t)}function w(e,r){var t=p(e);t?b(t,r):v(e,r)}function b(e,r){if(r.workerid=e.id,c)e.postMessage(r);else{var t=(o=r,function(){return e.postMessage(o)});n=t,u.push(n),s(l,0)}var n,o}return{runJob:v,continueJob:w,abortJob:function(e){var r=p(e);r&&h(r)},useWebWorkers:function(e){if("unavailable"!==f){if((!0!==e||"ready"!==f)&&(!1!==e||"available"!==f)){if(!1===e&&"ready"===f)return c=!1,f="available",void Y.consoleLog("web workers disabled.");if("pending"!==f){f="pending";var r=new Worker(t);r.addEventListener("message",n,!1),r.addEventListener("error",n,!1),r.postMessage({prngSeed:z.getBytes(48)})}}}else Y.consoleLog("web workers not available in this browser.");function n(e){var t=!(!e.data||!0!==e.data.initialized);if(r.removeEventListener("message",n,!1),r.removeEventListener("error",n,!1),r.terminate(),f=t?"ready":"failed",c=t,Y.consoleLog("web worker initialization "+(t?"succeeded. Now using web workers.":"failed. running synchronously."+(e.message||""))),o.length>0){var i=o.shift();v(i.operation,i.data)}}}}}();var l=[{name:"algorithm",type:"Object",required:!0},{name:"keyHandle",type:"Object",required:!0},{name:"buffer",type:"Array",required:!1},{name:"signature",type:"Array",required:!0},{name:"format",type:"String",required:!0},{name:"keyData",type:"Object",required:!0},{name:"extractable",type:"Boolean",required:!1},{name:"usages",type:"Array",required:!1},{name:"derivedKeyType",type:"Object",required:!0},{name:"length",type:"Number",required:!1},{name:"extractable",type:"Boolean",required:!0},{name:"usages",type:"Array",required:!0},{name:"keyData",type:"Array",required:!0}],f={encrypt:[0,1,2],decrypt:[0,1,2],sign:[0,1,2],verify:[0,1,3,2],digest:[0,2],generateKey:[0,6,7],importKeyRaw:[4,12,0,10,11],importKeyJwk:[4,5,0,10,11],exportKey:[0,4,1,6,7],deriveKey:[0,1,8,6,7],deriveBits:[0,1,9],wrapKey:[1,1,0],unwrapKey:[2,0,1,6,7]};function h(e){var r=a.lookup(e);if(!r)throw new Error("key not found");return r}function g(e,t,n){var u=function(e,r){var t,n,o,i,a={operationType:e};for("importKey"!==e||"raw"!==r[0]&&"spki"!==r[0]||(e="importKeyRaw"),"importKey"===e&&"jwk"===r[0]&&(e="importKeyJwk"),t=f[e],i=0;i<t.length;i+=1)if(n=l[t[i]],null!=(o=r[i])){if(o.subarray&&(o=Y.toArray(o)),"ArrayBuffer"===Y.getObjectType(o)&&(o=Y.toArray(o)),y.getObjectType(o)!==n.type)throw new Error(n.name);"algorithm"===n.name&&(o.name=o.name.toUpperCase(),o.iv&&(o.iv=Y.toArray(o.iv)),o.publicExponent&&(o.publicExponent=Y.toArray(o.publicExponent)),o.salt&&(o.salt=Y.toArray(o.salt)),o.additionalData&&(o.additionalData=Y.toArray(o.additionalData)),o.hash&&!o.hash.name&&"String"===Y.getObjectType(o.hash)&&(o.hash={name:o.hash})),a.hasOwnProperty(n.name)?a[n.name+"1"]=o:a[n.name]=o}else if(n.required)throw new Error(n.name);return a}(e,t);!function(e,t){if(!r.exists(e,t))throw new Error("unsupported algorithm")}(e,u.algorithm.name),u.keyHandle&&(u.keyData=h(u.keyHandle)),u.keyHandle1&&(u.keyData1=h(u.keyHandle1)),u.algorithm&&u.algorithm.public&&(u.additionalKeyData=h(u.algorithm.public));var c=n?o((function(e){var r,t;switch(e.type){case"keyGeneration":case"keyImport":case"keyDerive":return e.keyPair?(a.add(e.keyPair.publicKey.keyHandle,e.keyPair.publicKey.keyData),a.add(e.keyPair.privateKey.keyHandle,e.keyPair.privateKey.keyData),{publicKey:e.keyPair.publicKey.keyHandle,privateKey:e.keyPair.privateKey.keyHandle}):(a.add(e.keyHandle,e.keyData),e.keyHandle);case"keyExport":return e.keyHandle;case"keyPairGeneration":return t=e.keyPair.privateKey,r=e.keyPair.publicKey,a.add(r.keyHandle,r.keyData),a.add(t.keyHandle,t.keyData),{publicKey:r.keyHandle,privateKey:t.keyHandle};default:throw new Error("Unknown key operation")}})):i(u);return(n||u.buffer||"deriveBits"===e||"wrapKey"===e)&&s.runJob(c,u),c.stream?Promise.resolve(function(e){return{process:function(r){return e.process(r)},finish:function(){return e.finish()},abort:function(){return e.abort()}}}(c)):c.promise}var d={encrypt:function(e,r,t){return g("encrypt",arguments,0)},decrypt:function(e,r,t){return g("decrypt",arguments,0)},sign:function(e,r,t){return g("sign",arguments,0)},verify:function(e,r,t,n){return g("verify",arguments,0)},digest:function(e,r){return g("digest",arguments,0)},generateKey:function(e,r,t){return g("generateKey",arguments,1)},deriveKey:function(e,r,t,n,o){var i=this.deriveBits,a=this.importKey;return new Promise((function(u,s){var c;switch(t.name.toUpperCase()){case"AES-CBC":case"AES-GCM":c=t.length;break;case"HMAC":c=t.length||{"SHA-1":512,"SHA-224":512,"SHA-256":512,"SHA-384":1024,"SHA-512":1024}[t.hash.name.toUpperCase()];break;default:return void s(new Error("No Supported"))}i(e,r,c).then((function(e){return a("raw",e,t,n,o)})).then((function(e){u(e)})).catch((function(e){s(e)}))}))},deriveBits:function(e,r,t){return g("deriveBits",arguments,0)},importKey:function(e,r,t,n,o){return g("importKey",arguments,1)},exportKey:function(e,r){return g("exportKey",[r.algorithm,e,r],1)},wrapKey:function(e,r,t,n){var o=this.encrypt,i=this.exportKey;return new Promise((function(a,u){!1===r.extractable||r.usages.indexOf("wrapKey")<0||t.algorithm.name.toUpperCase()!==n.name?u(new Error("InvalidAccessError")):i(e,r).then((function(r){return o(n,t,"jwk"===e?Y.stringToBytes(JSON.stringify(r,null,0)):r)})).then((function(e){a(e)})).catch((function(e){u(e)}))}))},unwrapKey:function(e,r,t,n,o,i,a){var u=this.decrypt,s=this.importKey;return new Promise((function(c,l){t.usages.indexOf("unwrapKey")<0||t.algorithm.name.toUpperCase()!==n.name?l(new Error("InvalidAccessError")):u(n,t,r).then((function(r){return s(e,"jwk"===e?JSON.parse(Y.bytesToString(r)):r,o,i,a)})).then((function(e){c(e)})).catch((function(e){l(e)}))}))}};return{publicMethods:d,internalMethods:{useWebWorkers:s.useWebWorkers}}}();var _=function(){var e=y;return{wrapKey:function(r){var t=j(r.keyData1,r.keyHandle1.algorithm.name,f["SHA-1"])(),n=g.keyToJwkOld(r.keyHandle,r.keyData),o={alg:r.keyHandle1.algorithm.name.toUpperCase(),enc:"A128GCM"},i=e.toBase64(JSON.stringify(o),!0),a=z.getBytes(32),u=t.encrypt(a),s=e.toBase64(u,!0),c=z.getBytes(12),l=e.toBase64(c,!0),y=i.concat(".",s,".",l),h=B(I.aes(a));h.init(c,e.stringToBytes(y),128);var p=h.encrypt(n),d=p.slice(-16),m={recipients:[{header:i,encrypted_key:s,integrity_value:e.toBase64(d,!0)}],initialization_vector:l,ciphertext:e.toBase64(p.slice(0,p.length-d.length),!0)};return e.stringToBytes(JSON.stringify(m))},unwrapKey:function(r){var t=e.fromBase64,n=JSON.parse(String.fromCharCode.apply(null,r.buffer)),o=(e.fromBase64(n.recipients[0].header),t(n.recipients[0].encrypted_key)),i=t(n.recipients[0].integrity_value),a=t(n.initialization_vector),u=t(n.ciphertext),s=f["SHA-1"](),c=j(r.keyData,r.keyHandle.algorithm.name,s).decrypt(o),l=n.recipients[0].header.concat(".",n.recipients[0].encrypted_key,".",n.initialization_vector),y=B(I.aes(c));y.init(a,e.stringToBytes(l),128);var h=y.decrypt(u,i),p=g.jwkToKey(h,r.algorithm,["k"]);return{type:"keyImport",keyData:p.k,keyHandle:{algorithm:{name:r.algorithm.name},extractable:r.extractable||p.extractable,usages:r.usages,type:"secret"}}}}}();"undefined"!==typeof r&&(r.register("wrapKey","AES-GCM",_.wrapKey),r.register("unwrapKey","AES-CBC",_.unwrapKey));var X,$={subtle:J?J.publicMethods:null,getRandomValues:function(e){var r,t=z.getBytes(e.length);for(r=0;r<e.length;r+=1)e[r]=t[r];return e},initPrng:function(e){var r=Object.prototype.toString.call(e);if("[object Array]"!==r&&"[object Uint8Array]"!==r)throw new Error("entropyData must be a Array or Uint8Array");X&&X.reseed(e),z.reseed(X.read(48))},toBase64:function(e,r){return y.toBase64(e,r)},fromBase64:function(e){return y.fromBase64(e)},textToBytes:function(e){return y.stringToBytes(e)},bytesToText:function(e){return y.bytesToString(e)},asn1:h,url:t,version:msrCryptoVersion,useWebWorkers:function(e){return J?J.internalMethods.useWebWorkers(e):null}};X=X||new function(e){var r=[],t=new R,n=!1,o=!1,i=e;function a(){var a,u=["Cookie","RedirectUri","ETag","x-ms-client-antiforgery-id","x-ms-client-request-id","x-ms-client-session-id","SubscriptionPool"],l=[];for(a=0;a<48;a+=1)l[a]=Math.floor(256*Math.random());var f=i.crypto||i.msCrypto;if(f&&"function"===typeof f.getRandomValues&&e.Uint8Array){var h=new e.Uint8Array(48);f.getRandomValues(h),l=l.concat(Array.apply(null,h)),o=!0}if("undefined"!==typeof XMLHttpRequest){var p=new XMLHttpRequest;for(a=0;a<u.length;a+=1)try{var g=p.getResponseHeader(u[a]);if(g){var d=y.stringToBytes(g);l=l.concat(d)}}catch(m){}}!o&&s&&(l=l.concat(r.splice(0,r.length)),c.startCollectors()),n?t.reseed(l):t.init(l),n=!0}function u(e){for(var t=0;t<e.length;++t)r.push(e[t]);r.length>=128&&c.stopCollectors()}var s=e&&e.addEventListener||"undefined"!==typeof document&&document.attachEvent,c={startCollectors:function(){if(!this.collectorsRegistered){if(e.addEventListener)e.addEventListener("mousemove",this.MouseEventCallBack,!0),e.addEventListener("load",this.LoadTimeCallBack,!0);else{if(!document.attachEvent)throw new Error("Can't attach events for entropy collection");document.attachEvent("onmousemove",this.MouseEventCallBack),document.attachEvent("onload",this.LoadTimeCallBack)}this.collectorsRegistered=1}},stopCollectors:function(){this.collectorsRegistered&&(e.removeEventListener?(e.removeEventListener("mousemove",this.MouseEventCallBack,1),e.removeEventListener("load",this.LoadTimeCallBack,1)):e.detachEvent&&(e.detachEvent("onmousemove",this.MouseEventCallBack),e.detachEvent("onload",this.LoadTimeCallBack)),this.collectorsRegistered=0)},MouseEventCallBack:function(e){var r=(new Date).valueOf(),t=e.x||e.clientX||e.offsetX||0,n=e.y||e.clientY||e.offsetY||0;u([255&r,r>>8&255,r>>16&255,r>>24&255,255&t,t>>8&255,255&n,n>>8&255])},LoadTimeCallBack:function(){var e=(new Date).valueOf();u([255&e,e>>8&255,e>>16&255,e>>24&255])}};return{init:function(){if(a(),!o&&s)try{c.startCollectors()}catch(e){}},reseed:function(e){t.reseed(e)},read:function(e){if(!n)throw new Error("Entropy pool is not initialized.");var r=t.getBytes(e);return a(),r}}}(e),X.init();var ee=X.read(48);return z.init(ee),$}()})),function(e){"undefined"===typeof Promise&&(e.Promise=function(){var e=function(r,t){if(!(this instanceof e))throw new Error("use 'new' keyword with Promise constructor");var n=null,o=null,i=[],a=[],u=[],s=[];function c(e){var r,t;for(t=0;t<i.length;t+=1)(r=i[t](e))&&r.then?(r.then(s[t]),u[t]&&r.catch(u[t])):s[t]&&s[t](r);n={result:e}}function l(e){var r,t;for(t=0;t<a.length;t+=1)(r=a[t](e))&&r.then?r.then(s[t],u[t]):s[t]&&s[t](r);o={result:e}}this.then=function(r,t){var c;return n?(c=r(n.result))&&c.then?c:e.resolve(c):o?(c=t?t(o.result):o.result)&&c.then?c:e.resolve(c):(i.push(r),t&&a.push(t),new e((function(e,r){s.push(e),u.push(r)})))},this.catch=function(r){var t;return o?(t=r(o.result))&&t.then?t:e.resolve(t):(a.push(r),new e((function(e,r){s.push(e),u.push(r)})))},r(c,l)};return e.all=function(r){var t=[],n=0;function o(e,o){return function(i){t[e]=i,(n+=1)===r.length&&o(t)}}return new e((function(t,n){var i;function a(e){n(e)}for(i=0;i<r.length;i+=1)r[i].then?(r[i].then(o(i,t)),r[i].catch(a)):e.resolve(r[i]).then(o(i,t))}))},e.race=function(r){var t=!1;function n(e){return function(r){t||(t=!0,e(r))}}return new e((function(e,t){for(var o=0;o<r.length;o+=1)r[o].then(n(e),n(t))}))},e.reject=function(r){return new e((function(e,t){t(r)}))},e.resolve=function(r){return new e((function(e,t){e(r)}))},e}())}(this);